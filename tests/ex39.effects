Require [ OCaml.List ]

3
Value
  (non_rec, @.,
    [
      ((get_local_ref, [ ], [ (tt (= tt_1), Type (unit)) ],
        Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (Z))),
        LetVar (4, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .))
          x =
          Apply
            ((4, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
              Variable
                ((4,
                  Effect
                    ([ ],
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ]-> .)), OCaml.Pervasives.ref),
              [ Constant ((4, Effect ([ ], .)), Int(12)) ]) in
        Apply
          ((5, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable
              ((5,
                Effect
                  ([ ],
                    .
                      -[
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ]-> .)), OCaml.Effect.State.read),
            [ Variable ((5, Effect ([ ], .)), x) ]))
    ])

7
Value
  (non_rec, @.,
    [
      ((set_local_ref, [ ], [ (tt (= tt_1), Type (unit)) ],
        Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (Z))),
        LetVar (8, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .))
          x =
          Apply
            ((8, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
              Variable
                ((8,
                  Effect
                    ([ ],
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ]-> .)), OCaml.Pervasives.ref),
              [ Constant ((8, Effect ([ ], .)), Int(12)) ]) in
        Sequence
          ((9, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Apply
              ((9,
                Effect
                  ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
                Variable
                  ((9,
                    Effect
                      ([ ],
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]-> .)),
                    OCaml.Effect.State.write),
                [
                  Variable ((9, Effect ([ ], .)), x);
                  Constant ((9, Effect ([ ], .)), Int(15))
                ]),
            Apply
              ((10,
                Effect
                  ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
                Variable
                  ((10,
                    Effect
                      ([ ],
                        .
                          -[
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z))
                          ]-> .)), OCaml.Effect.State.read),
                [ Variable ((10, Effect ([ ], .)), x) ])))
    ])

12
Value
  (non_rec, @.,
    [
      ((add_multiple_by_refs, [ ],
        [ (a, Type (Z)); (b, Type (Z)); (c, Type (Z)); (d, Type (Z)) ],
        Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (Z))),
        LetVar (13, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .))
          x =
          Apply
            ((13,
              Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
              Variable
                ((13,
                  Effect
                    ([ ],
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ]-> .)), OCaml.Pervasives.ref),
              [ Variable ((13, Effect ([ ], .)), a) ]) in
        Sequence
          ((14, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Apply
              ((14,
                Effect
                  ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
                Variable
                  ((14,
                    Effect
                      ([ ],
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]-> .)),
                    OCaml.Effect.State.write),
                [
                  Variable ((14, Effect ([ ], .)), x);
                  Apply
                    ((14,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .)),
                      Variable
                        ((14,
                          Effect
                            ([
                            ],
                              .
                                ->
                                .
                                  ->
                                  .)),
                          Z.add),
                      [
                        Apply
                          ((14,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ],
                                .)),
                            Variable
                              ((14,
                                Effect
                                  ([
                                  ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ]->
                                      .)),
                                OCaml.Effect.State.read),
                            [
                              Variable
                                ((14,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  x)
                            ]);
                        Variable
                          ((14,
                            Effect
                              ([
                              ],
                                .)),
                            b)
                      ])
                ]),
            LetVar
              (15,
                Effect
                  ([ Type (OCaml.Effect.State.state, Type (Z)) ], .))
              y =
              Apply
                ((15,
                  Effect
                    ([ Type (OCaml.Effect.State.state, Type (Z)) ],
                      .)),
                  Variable
                    ((15,
                      Effect
                        ([ ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]-> .)), OCaml.Pervasives.ref),
                  [ Variable ((15, Effect ([ ], .)), c) ]) in
            Sequence
              ((16,
                Effect
                  ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
                Apply
                  ((16,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ], .)),
                    Variable
                      ((16,
                        Effect
                          ([ ],
                            . ->
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]-> .)),
                        OCaml.Effect.State.write),
                    [
                      Variable ((16, Effect ([ ], .)), y);
                      Apply
                        ((16,
                          Effect
                            ([
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ],
                              .)),
                          Variable
                            ((16,
                              Effect
                                ([
                                ],
                                  .
                                    ->
                                    .
                                      ->
                                      .)),
                              Z.add),
                          [
                            Apply
                              ((16,
                                Effect
                                  ([
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ],
                                    .)),
                                Variable
                                  ((16,
                                    Effect
                                      ([
                                      ],
                                        .
                                          -[
                                            Type
                                              (OCaml.Effect.State.state,
                                                Type
                                                  (Z))
                                          ]->
                                          .)),
                                    OCaml.Effect.State.read),
                                [
                                  Variable
                                    ((16,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      y)
                                ]);
                            Variable
                              ((16,
                                Effect
                                  ([
                                  ],
                                    .)),
                                d)
                          ])
                    ]),
                LetVar
                  (17,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ], .)) z =
                  Apply
                    ((17,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ], .)),
                      Variable
                        ((17,
                          Effect
                            ([ ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]-> .)),
                          OCaml.Pervasives.ref),
                      [
                        Apply
                          ((17,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ],
                                .)),
                            Variable
                              ((17,
                                Effect
                                  ([
                                  ],
                                    .
                                      ->
                                      .
                                        ->
                                        .)),
                                Z.add),
                            [
                              Apply
                                ((17,
                                  Effect
                                    ([
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z))
                                    ],
                                      .)),
                                  Variable
                                    ((17,
                                      Effect
                                        ([
                                        ],
                                          .
                                            -[
                                              Type
                                                (OCaml.Effect.State.state,
                                                  Type
                                                    (Z))
                                            ]->
                                            .)),
                                      OCaml.Effect.State.read),
                                  [
                                    Variable
                                      ((17,
                                        Effect
                                          ([
                                          ],
                                            .)),
                                        x)
                                  ]);
                              Apply
                                ((17,
                                  Effect
                                    ([
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z))
                                    ],
                                      .)),
                                  Variable
                                    ((17,
                                      Effect
                                        ([
                                        ],
                                          .
                                            -[
                                              Type
                                                (OCaml.Effect.State.state,
                                                  Type
                                                    (Z))
                                            ]->
                                            .)),
                                      OCaml.Effect.State.read),
                                  [
                                    Variable
                                      ((17,
                                        Effect
                                          ([
                                          ],
                                            .)),
                                        y)
                                  ])
                            ])
                      ]) in
                Apply
                  ((18,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ], .)),
                    Variable
                      ((18,
                        Effect
                          ([ ],
                            .
                              -[
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ]-> .)),
                        OCaml.Effect.State.read),
                    [ Variable ((18, Effect ([ ], .)), z) ]))))
    ])

20
Value
  (non_rec, @.,
    [
      ((set_ref, [ ], [ (x, Type (OCaml.Effect.State.t, Type (Z))) ],
        Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (unit))),
        Apply
          ((21, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable
              ((21,
                Effect
                  ([ ],
                    . ->
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ]-> .)), OCaml.Effect.State.write),
            [
              Variable ((21, Effect ([ ], .)), x);
              Constant ((21, Effect ([ ], .)), Int(15))
            ]))
    ])

23
Value
  (non_rec, @.,
    [
      ((get_ref, [ ], [ (x, Type (OCaml.Effect.State.t, Type (Z))) ],
        Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (Z))),
        Apply
          ((24, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable
              ((24,
                Effect
                  ([ ],
                    .
                      -[
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ]-> .)), OCaml.Effect.State.read),
            [ Variable ((24, Effect ([ ], .)), x) ]))
    ])

26
Value
  (non_rec, @.,
    [
      ((update_ref, [ ], [ (x, Type (OCaml.Effect.State.t, Type (Z))) ],
        Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (unit))),
        Apply
          ((27, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable
              ((27,
                Effect
                  ([ ],
                    . ->
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ]-> .)), OCaml.Effect.State.write),
            [
              Variable ((27, Effect ([ ], .)), x);
              Apply
                ((27,
                  Effect
                    ([
                      Type
                        (OCaml.Effect.State.state,
                          Type
                            (Z))
                    ], .)),
                  Variable
                    ((27,
                      Effect
                        ([
                        ],
                          .
                            ->
                            .
                              ->
                              .)),
                      Z.add),
                  [
                    Apply
                      ((27,
                        Effect
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z))
                          ],
                            .)),
                        Variable
                          ((27,
                            Effect
                              ([
                              ],
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .)),
                            OCaml.Effect.State.read),
                        [
                          Variable
                            ((27,
                              Effect
                                ([
                                ],
                                  .)),
                              x)
                        ]);
                    Constant
                      ((27,
                        Effect
                          ([
                          ],
                            .)),
                        Int(5))
                  ])
            ]))
    ])

29
Value
  (non_rec, @.,
    [
      ((new_ref, [ ], [ (x, Type (unit)) ],
        Monad
          ([ Type (OCaml.Effect.State.state, Type (Z)) ],
            Type (OCaml.Effect.State.t, Type (Z)))),
        Apply
          ((30, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable
              ((30,
                Effect
                  ([ ],
                    .
                      -[
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ]-> .)), OCaml.Pervasives.ref),
            [ Constant ((30, Effect ([ ], .)), Int(15)) ]))
    ])

32 Reference (r, r_state, Type (Z), Constant ((32, Effect ([ ], .)), Int(18)))

34
Value
  (non_rec, @.,
    [
      ((set_r, [ ], [ (x, Type (unit)) ],
        Monad
          ([ Type (OCaml.Effect.State.state, Type (Z)); Type (r_state) ],
            Type (unit))),
        Apply
          ((34,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (r_state)
              ], .)),
            Variable
              ((34,
                Effect
                  ([ ],
                    .
                      -[
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ]-> .)), set_ref),
            [
              Variable
                ((34,
                  Effect
                    ([
                      Type
                        (OCaml.Effect.State.state,
                          Type
                            (Z));
                      Type
                        (r_state)
                    ], .)),
                  r)
            ]))
    ])

36
Value
  (non_rec, @.,
    [
      ((get_r, [ ], [ (x, Type (unit)) ],
        Monad
          ([ Type (OCaml.Effect.State.state, Type (Z)); Type (r_state) ],
            Type (Z))),
        Apply
          ((36,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (r_state)
              ], .)),
            Variable
              ((36,
                Effect
                  ([ ],
                    .
                      -[
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ]-> .)), get_ref),
            [
              Variable
                ((36,
                  Effect
                    ([
                      Type
                        (OCaml.Effect.State.state,
                          Type
                            (Z));
                      Type
                        (r_state)
                    ], .)),
                  r)
            ]))
    ])

38
Value
  (non_rec, @.,
    [
      ((r_add_15, [ ], [ (x, Type (unit)) ],
        Monad
          ([ Type (OCaml.Effect.State.state, Type (Z)); Type (r_state) ],
            Type (Z))),
        LetVar
          (39,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (r_state)
              ], .)) i =
          Apply
            ((39,
              Effect
                ([
                  Type (OCaml.Effect.State.state, Type (Z));
                  Type (r_state)
                ], .)),
              Variable
                ((39,
                  Effect
                    ([ ],
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z));
                          Type (r_state)
                        ]-> .)), get_r),
              [ Constructor ((39, Effect ([ ], .)), tt) ]) in
        Sequence
          ((40,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (r_state)
              ], .)),
            Apply
              ((40,
                Effect
                  ([
                    Type (OCaml.Effect.State.state, Type (Z));
                    Type (r_state)
                  ], .)),
                Variable
                  ((40,
                    Effect
                      ([ ],
                        .
                          -[
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z));
                            Type (r_state)
                          ]-> .)), set_r),
                [ Constructor ((40, Effect ([ ], .)), tt) ]),
            LetVar
              (41,
                Effect
                  ([
                    Type (OCaml.Effect.State.state, Type (Z));
                    Type (r_state)
                  ], .)) j =
              Apply
                ((41,
                  Effect
                    ([
                      Type (OCaml.Effect.State.state, Type (Z));
                      Type (r_state)
                    ], .)),
                  Variable
                    ((41,
                      Effect
                        ([ ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z));
                              Type (r_state)
                            ]-> .)), get_r),
                  [ Constructor ((41, Effect ([ ], .)), tt) ]) in
            Sequence
              ((42,
                Effect
                  ([
                    Type (OCaml.Effect.State.state, Type (Z));
                    Type (r_state)
                  ], .)),
                Apply
                  ((42,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type (r_state)
                      ], .)),
                    Variable
                      ((42,
                        Effect
                          ([ ],
                            . ->
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]-> .)),
                        OCaml.Effect.State.write),
                    [
                      Variable
                        ((42,
                          Effect
                            ([
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (r_state)
                            ],
                              .)),
                          r);
                      Apply
                        ((42,
                          Effect
                            ([
                            ],
                              .)),
                          Variable
                            ((42,
                              Effect
                                ([
                                ],
                                  .
                                    ->
                                    .
                                      ->
                                      .)),
                              Z.add),
                          [
                            Variable
                              ((42,
                                Effect
                                  ([
                                  ],
                                    .)),
                                i);
                            Variable
                              ((42,
                                Effect
                                  ([
                                  ],
                                    .)),
                                j)
                          ])
                    ]),
                Apply
                  ((43,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type (r_state)
                      ], .)),
                    Variable
                      ((43,
                        Effect
                          ([ ],
                            .
                              -[
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ]-> .)),
                        OCaml.Effect.State.read),
                    [
                      Variable
                        ((43,
                          Effect
                            ([
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (r_state)
                            ],
                              .)),
                          r)
                    ]))))
    ])

45
Value
  (non_rec, @.,
    [
      ((mixed_type, [ ], [ (x, Type (unit)) ],
        Monad
          ([
            Type (OCaml.Effect.State.state, Type (Z));
            Type (OCaml.Effect.State.state, Type (bool));
            Type (OCaml.Effect.State.state, Type (string));
            Type (r_state)
          ], (Type (bool) * Type (string) * Type (Z)))),
        LetVar
          (46,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (OCaml.Effect.State.state, Type (bool));
                Type (OCaml.Effect.State.state, Type (string));
                Type (r_state)
              ], .)) b =
          Apply
            ((46,
              Effect
                ([ Type (OCaml.Effect.State.state, Type (bool)) ], .)),
              Variable
                ((46,
                  Effect
                    ([ ],
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (bool))
                        ]-> .)), OCaml.Pervasives.ref),
              [ Constructor ((46, Effect ([ ], .)), true) ]) in
        LetVar
          (47,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (OCaml.Effect.State.state, Type (bool));
                Type (OCaml.Effect.State.state, Type (string));
                Type (r_state)
              ], .)) str =
          Apply
            ((47,
              Effect
                ([ Type (OCaml.Effect.State.state, Type (string)) ], .)),
              Variable
                ((47,
                  Effect
                    ([ ],
                      .
                        -[
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (string))
                        ]-> .)), OCaml.Pervasives.ref),
              [ Constant ((47, Effect ([ ], .)), String("")) ]) in
        LetFun
          (48,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (OCaml.Effect.State.state, Type (bool));
                Type (OCaml.Effect.State.state, Type (string));
                Type (r_state)
              ], .))
          (non_rec, @.,
            [
              ((update, [ ], [ (x_1, Type (unit)) ],
                Monad
                  ([
                    Type
                      (OCaml.Effect.State.state,
                        Type
                          (bool));
                    Type
                      (OCaml.Effect.State.state,
                        Type
                          (string))
                  ], Type (unit))),
                Match
                  ((?,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (bool));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (string))
                      ],
                        .)),
                    Variable
                      ((?,
                        Effect
                          ([
                          ],
                            .)),
                        x_1),
                    [
                      (Constructor
                        (tt),
                        Sequence
                          ((49,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (bool));
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (string))
                              ],
                                .)),
                            Apply
                              ((49,
                                Effect
                                  ([
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (bool))
                                  ],
                                    .)),
                                Variable
                                  ((49,
                                    Effect
                                      ([
                                      ],
                                        .
                                          ->
                                          .
                                            -[
                                              Type
                                                (OCaml.Effect.State.state,
                                                  Type
                                                    (bool))
                                            ]->
                                            .)),
                                    OCaml.Effect.State.write),
                                [
                                  Variable
                                    ((49,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      b);
                                  Apply
                                    ((49,
                                      Effect
                                        ([
                                          Type
                                            (OCaml.Effect.State.state,
                                              Type
                                                (bool))
                                        ],
                                          .)),
                                      Variable
                                        ((49,
                                          Effect
                                            ([
                                            ],
                                              .
                                                -[
                                                  Type
                                                    (OCaml.Effect.State.state,
                                                      Type
                                                        (bool))
                                                ]->
                                                .)),
                                          OCaml.Effect.State.read),
                                      [
                                        Variable
                                          ((49,
                                            Effect
                                              ([
                                              ],
                                                .)),
                                            b)
                                      ])
                                ]),
                            Apply
                              ((50,
                                Effect
                                  ([
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (string))
                                  ],
                                    .)),
                                Variable
                                  ((50,
                                    Effect
                                      ([
                                      ],
                                        .
                                          ->
                                          .
                                            -[
                                              Type
                                                (OCaml.Effect.State.state,
                                                  Type
                                                    (string))
                                            ]->
                                            .)),
                                    OCaml.Effect.State.write),
                                [
                                  Variable
                                    ((50,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      str);
                                  Apply
                                    ((50,
                                      Effect
                                        ([
                                          Type
                                            (OCaml.Effect.State.state,
                                              Type
                                                (string))
                                        ],
                                          .)),
                                      Variable
                                        ((50,
                                          Effect
                                            ([
                                            ],
                                              .
                                                ->
                                                .
                                                  ->
                                                  .)),
                                          String.append),
                                      [
                                        Constant
                                          ((50,
                                            Effect
                                              ([
                                              ],
                                                .)),
                                            String("toggle "));
                                        Apply
                                          ((50,
                                            Effect
                                              ([
                                                Type
                                                  (OCaml.Effect.State.state,
                                                    Type
                                                      (string))
                                              ],
                                                .)),
                                            Variable
                                              ((50,
                                                Effect
                                                  ([
                                                  ],
                                                    .
                                                      -[
                                                        Type
                                                          (OCaml.Effect.State.state,
                                                            Type
                                                              (string))
                                                      ]->
                                                      .)),
                                                OCaml.Effect.State.read),
                                            [
                                              Variable
                                                ((50,
                                                  Effect
                                                    ([
                                                    ],
                                                      .)),
                                                  str)
                                            ])
                                      ])
                                ])))
                    ]))
            ]) in
        Sequence
          ((51,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (OCaml.Effect.State.state, Type (bool));
                Type (OCaml.Effect.State.state, Type (string));
                Type (r_state)
              ], .)),
            Apply
              ((51,
                Effect
                  ([
                    Type (OCaml.Effect.State.state, Type (bool));
                    Type (OCaml.Effect.State.state, Type (string))
                  ], .)),
                Variable
                  ((51,
                    Effect
                      ([ ],
                        .
                          -[
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (bool));
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (string))
                          ]-> .)), update),
                [ Constructor ((51, Effect ([ ], .)), tt) ]),
            Sequence
              ((52,
                Effect
                  ([
                    Type (OCaml.Effect.State.state, Type (Z));
                    Type (OCaml.Effect.State.state, Type (bool));
                    Type (OCaml.Effect.State.state, Type (string));
                    Type (r_state)
                  ], .)),
                Apply
                  ((52,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (bool));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (string))
                      ], .)),
                    Variable
                      ((52,
                        Effect
                          ([ ],
                            .
                              -[
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (bool));
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (string))
                              ]-> .)), update),
                    [ Constructor ((52, Effect ([ ], .)), tt) ]),
                Sequence
                  ((53,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (bool));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (string));
                        Type (r_state)
                      ], .)),
                    Apply
                      ((53,
                        Effect
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (bool));
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (string))
                          ], .)),
                        Variable
                          ((53,
                            Effect
                              ([ ],
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (bool));
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (string))
                                  ]-> .)), update),
                        [
                          Constructor
                            ((53,
                              Effect
                                ([
                                ],
                                  .)),
                              tt)
                        ]),
                    Tuple
                      ((54,
                        Effect
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z));
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (bool));
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (string));
                            Type (r_state)
                          ], .)),
                        Apply
                          ((54,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (bool))
                              ], .)),
                            Variable
                              ((54,
                                Effect
                                  ([ ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (bool))
                                      ]-> .)),
                                OCaml.Effect.State.read),
                            [
                              Variable
                                ((54,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  b)
                            ]),
                        Apply
                          ((54,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (string))
                              ], .)),
                            Variable
                              ((54,
                                Effect
                                  ([ ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (string))
                                      ]-> .)),
                                OCaml.Effect.State.read),
                            [
                              Variable
                                ((54,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  str)
                            ]),
                        Apply
                          ((54,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z));
                                Type (r_state)
                              ], .)),
                            Variable
                              ((54,
                                Effect
                                  ([ ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ]-> .)),
                                OCaml.Effect.State.read),
                            [
                              Variable
                                ((54,
                                  Effect
                                    ([
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z));
                                      Type
                                        (r_state)
                                    ],
                                      .)),
                                  r)
                            ]))))))
    ])

56
Value
  (non_rec, @.,
    [
      ((partials_test, [ ], [ (x, Type (unit)) ],
        Monad
          ([
            Type (OCaml.Effect.State.state, Type (Z));
            Type (OCaml.Effect.State.state, Type (list, Type (Z)));
            Type (r_state)
          ], Type (OCaml.Effect.State.t, Type (Z)))),
        Match
          ((?,
            Effect
              ([
                Type (OCaml.Effect.State.state, Type (Z));
                Type (OCaml.Effect.State.state, Type (list, Type (Z)));
                Type (r_state)
              ], .)), Variable ((?, Effect ([ ], .)), x),
            [
              (Constructor (tt),
                LetFun
                  (57,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (list,
                                Type
                                  (Z)));
                        Type
                          (r_state)
                      ],
                        .))
                  (non_rec, @.,
                    [
                      ((f1,
                        [
                        ],
                        [
                          (x,
                            Type
                              (OCaml.Effect.State.t,
                                Type
                                  (Z)));
                          (y,
                            Type
                              (Z))
                        ],
                        Monad
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z))
                          ],
                            Type
                              (OCaml.Effect.State.t,
                                Type
                                  (Z)))),
                        Sequence
                          ((58,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ],
                                .)),
                            Apply
                              ((58,
                                Effect
                                  ([
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ],
                                    .)),
                                Variable
                                  ((58,
                                    Effect
                                      ([
                                      ],
                                        .
                                          ->
                                          .
                                            -[
                                              Type
                                                (OCaml.Effect.State.state,
                                                  Type
                                                    (Z))
                                            ]->
                                            .)),
                                    OCaml.Effect.State.write),
                                [
                                  Variable
                                    ((58,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      x);
                                  Variable
                                    ((58,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      y)
                                ]),
                            Variable
                              ((59,
                                Effect
                                  ([
                                  ],
                                    .)),
                                x)))
                    ])
                  in
                LetVar
                  (60,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (list,
                                Type
                                  (Z)));
                        Type
                          (r_state)
                      ],
                        .))
                  f1_test =
                  Apply
                    ((60,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z));
                          Type
                            (r_state)
                        ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]->
                            .)),
                      Variable
                        ((60,
                          Effect
                            ([
                            ],
                              .
                                ->
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .)),
                          f1),
                      [
                        Variable
                          ((60,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z));
                                Type
                                  (r_state)
                              ],
                                .)),
                            r)
                      ])
                  in
                LetVar
                  (61,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (list,
                                Type
                                  (Z)))
                      ],
                        .))
                  f1_test =
                  Apply
                    ((61,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .)),
                      Variable
                        ((61,
                          Effect
                            ([
                            ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .)),
                          f1_test),
                      [
                        Constant
                          ((61,
                            Effect
                              ([
                              ],
                                .)),
                            Int(15))
                      ])
                  in
                LetFun
                  (62,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (list,
                                Type
                                  (Z)))
                      ],
                        .))
                  (non_rec, @.,
                    [
                      ((f2,
                        [
                        ],
                        [
                          (l1,
                            Type
                              (OCaml.Effect.State.t,
                                Type
                                  (list,
                                    Type
                                      (Z))));
                          (l2,
                            Type
                              (list,
                                Type
                                  (string)))
                        ],
                        Monad
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z));
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (list,
                                    Type
                                      (Z)))
                          ],
                            Type
                              (OCaml.Effect.State.t,
                                Type
                                  (Z)))),
                        Apply
                          ((63,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z));
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (list,
                                        Type
                                          (Z)))
                              ],
                                .)),
                            Variable
                              ((63,
                                Effect
                                  ([
                                  ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ]->
                                      .)),
                                OCaml.Pervasives.ref),
                            [
                              Apply
                                ((63,
                                  Effect
                                    ([
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (list,
                                              Type
                                                (Z)))
                                    ],
                                      .)),
                                  Variable
                                    ((63,
                                      Effect
                                        ([
                                        ],
                                          .
                                            ->
                                            .
                                              ->
                                              .)),
                                      Z.add),
                                  [
                                    Apply
                                      ((63,
                                        Effect
                                          ([
                                            Type
                                              (OCaml.Effect.State.state,
                                                Type
                                                  (list,
                                                    Type
                                                      (Z)))
                                          ],
                                            .)),
                                        Variable
                                          ((63,
                                            Effect
                                              ([
                                              ],
                                                .
                                                  ->
                                                  .)),
                                            OCaml.List.length),
                                        [
                                          Apply
                                            ((63,
                                              Effect
                                                ([
                                                  Type
                                                    (OCaml.Effect.State.state,
                                                      Type
                                                        (list,
                                                          Type
                                                            (Z)))
                                                ],
                                                  .)),
                                              Variable
                                                ((63,
                                                  Effect
                                                    ([
                                                    ],
                                                      .
                                                        -[
                                                          Type
                                                            (OCaml.Effect.State.state,
                                                              Type
                                                                (list,
                                                                  Type
                                                                    (Z)))
                                                        ]->
                                                        .)),
                                                  OCaml.Effect.State.read),
                                              [
                                                Variable
                                                  ((63,
                                                    Effect
                                                      ([
                                                      ],
                                                        .)),
                                                    l1)
                                              ])
                                        ]);
                                    Apply
                                      ((63,
                                        Effect
                                          ([
                                          ],
                                            .)),
                                        Variable
                                          ((63,
                                            Effect
                                              ([
                                              ],
                                                .
                                                  ->
                                                  .)),
                                            OCaml.List.length),
                                        [
                                          Variable
                                            ((63,
                                              Effect
                                                ([
                                                ],
                                                  .)),
                                              l2)
                                        ])
                                  ])
                            ]))
                    ])
                  in
                LetVar
                  (64,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (list,
                                Type
                                  (Z)))
                      ],
                        .))
                  f2_test =
                  Apply
                    ((64,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (list,
                                  Type
                                    (Z)))
                        ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (list,
                                      Type
                                        (Z)))
                            ]->
                            .)),
                      Variable
                        ((64,
                          Effect
                            ([
                            ],
                              .
                                ->
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z));
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (list,
                                            Type
                                              (Z)))
                                  ]->
                                  .)),
                          f2),
                      [
                        Apply
                          ((64,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (list,
                                        Type
                                          (Z)))
                              ],
                                .)),
                            Variable
                              ((64,
                                Effect
                                  ([
                                  ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (list,
                                                Type
                                                  (Z)))
                                      ]->
                                      .)),
                                OCaml.Pervasives.ref),
                            [
                              Constructor
                                ((64,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  cons,
                                  Constant
                                    ((64,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      Int(1)),
                                  Constructor
                                    ((64,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      cons,
                                      Constant
                                        ((64,
                                          Effect
                                            ([
                                            ],
                                              .)),
                                          Int(2)),
                                      Constructor
                                        ((64,
                                          Effect
                                            ([
                                            ],
                                              .)),
                                          cons,
                                          Constant
                                            ((64,
                                              Effect
                                                ([
                                                ],
                                                  .)),
                                              Int(3)),
                                          Constructor
                                            ((64,
                                              Effect
                                                ([
                                                ],
                                                  .)),
                                              []))))
                            ])
                      ])
                  in
                LetVar
                  (65,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z));
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (list,
                                Type
                                  (Z)))
                      ],
                        .))
                  f2_test =
                  Apply
                    ((65,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z));
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (list,
                                  Type
                                    (Z)))
                        ],
                          .)),
                      Variable
                        ((65,
                          Effect
                            ([
                            ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z));
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (list,
                                          Type
                                            (Z)))
                                ]->
                                .)),
                          f2_test),
                      [
                        Constructor
                          ((65,
                            Effect
                              ([
                              ],
                                .)),
                            cons,
                            Constant
                              ((65,
                                Effect
                                  ([
                                  ],
                                    .)),
                                String("hi")),
                            Constructor
                              ((65,
                                Effect
                                  ([
                                  ],
                                    .)),
                                cons,
                                Constant
                                  ((65,
                                    Effect
                                      ([
                                      ],
                                        .)),
                                    String("hey")),
                                Constructor
                                  ((65,
                                    Effect
                                      ([
                                      ],
                                        .)),
                                    [])))
                      ])
                  in
                Apply
                  ((66,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .)),
                    Variable
                      ((66,
                        Effect
                          ([
                          ],
                            .
                              ->
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .)),
                        f1),
                    [
                      Variable
                        ((66,
                          Effect
                            ([
                            ],
                              .)),
                          f2_test);
                      Apply
                        ((66,
                          Effect
                            ([
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ],
                              .)),
                          Variable
                            ((66,
                              Effect
                                ([
                                ],
                                  .
                                    -[
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z))
                                    ]->
                                    .)),
                              OCaml.Effect.State.read),
                          [
                            Variable
                              ((66,
                                Effect
                                  ([
                                  ],
                                    .)),
                                f1_test)
                          ])
                    ]))
            ]))
    ])

68
Value
  (non_rec, @.,
    [
      ((multiple_returns_test, [ ], [ (x, Type (unit)) ],
        Monad
          ([ Type (OCaml.Effect.State.state, Type (Z)) ],
            (Type (Z) * Type (OCaml.Effect.State.t, Type (Z))))),
        Match
          ((?, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable ((?, Effect ([ ], .)), x),
            [
              (Constructor (tt),
                LetFun
                  (69,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .))
                  (non_rec, @.,
                    [
                      ((f,
                        [
                        ],
                        [
                          (x,
                            Type
                              (OCaml.Effect.State.t,
                                Type
                                  (Z)));
                          (y,
                            Type
                              (Z))
                        ],
                        Monad
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z))
                          ],
                            (Type
                              (Z)
                              ->
                              Monad
                                ([
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ],
                                  (Type
                                    (OCaml.Effect.State.t,
                                      Type
                                        (Z))
                                    ->
                                    Monad
                                      ([
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ],
                                        Type
                                          (OCaml.Effect.State.t,
                                            Type
                                              (Z)))))))),
                        Sequence
                          ((70,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ],
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .
                                    -[
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z))
                                    ]->
                                    .)),
                            Apply
                              ((70,
                                Effect
                                  ([
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ],
                                    .)),
                                Variable
                                  ((70,
                                    Effect
                                      ([
                                      ],
                                        .
                                          ->
                                          .
                                            -[
                                              Type
                                                (OCaml.Effect.State.state,
                                                  Type
                                                    (Z))
                                            ]->
                                            .)),
                                    OCaml.Effect.State.write),
                                [
                                  Variable
                                    ((70,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      x);
                                  Variable
                                    ((70,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      y)
                                ]),
                            Function
                              ((71,
                                Effect
                                  ([
                                  ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ]->
                                      .
                                        -[
                                          Type
                                            (OCaml.Effect.State.state,
                                              Type
                                                (Z))
                                        ]->
                                        .)),
                                z,
                                Sequence
                                  ((71,
                                    Effect
                                      ([
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ],
                                        .
                                          -[
                                            Type
                                              (OCaml.Effect.State.state,
                                                Type
                                                  (Z))
                                          ]->
                                          .)),
                                    Apply
                                      ((72,
                                        Effect
                                          ([
                                            Type
                                              (OCaml.Effect.State.state,
                                                Type
                                                  (Z))
                                          ],
                                            .)),
                                        Variable
                                          ((72,
                                            Effect
                                              ([
                                              ],
                                                .
                                                  ->
                                                  .
                                                    -[
                                                      Type
                                                        (OCaml.Effect.State.state,
                                                          Type
                                                            (Z))
                                                    ]->
                                                    .)),
                                            OCaml.Effect.State.write),
                                        [
                                          Variable
                                            ((72,
                                              Effect
                                                ([
                                                ],
                                                  .)),
                                              x);
                                          Apply
                                            ((72,
                                              Effect
                                                ([
                                                  Type
                                                    (OCaml.Effect.State.state,
                                                      Type
                                                        (Z))
                                                ],
                                                  .)),
                                              Variable
                                                ((72,
                                                  Effect
                                                    ([
                                                    ],
                                                      .
                                                        ->
                                                        .
                                                          ->
                                                          .)),
                                                  Z.add),
                                              [
                                                Apply
                                                  ((72,
                                                    Effect
                                                      ([
                                                        Type
                                                          (OCaml.Effect.State.state,
                                                            Type
                                                              (Z))
                                                      ],
                                                        .)),
                                                    Variable
                                                      ((72,
                                                        Effect
                                                          ([
                                                          ],
                                                            .
                                                              -[
                                                                Type
                                                                  (OCaml.Effect.State.state,
                                                                    Type
                                                                      (Z))
                                                              ]->
                                                              .)),
                                                        OCaml.Effect.State.read),
                                                    [
                                                      Variable
                                                        ((72,
                                                          Effect
                                                            ([
                                                            ],
                                                              .)),
                                                          x)
                                                    ]);
                                                Variable
                                                  ((72,
                                                    Effect
                                                      ([
                                                      ],
                                                        .)),
                                                    z)
                                              ])
                                        ]),
                                    Function
                                      ((73,
                                        Effect
                                          ([
                                          ],
                                            .
                                              -[
                                                Type
                                                  (OCaml.Effect.State.state,
                                                    Type
                                                      (Z))
                                              ]->
                                              .)),
                                        w,
                                        LetVar
                                          (73,
                                            Effect
                                              ([
                                                Type
                                                  (OCaml.Effect.State.state,
                                                    Type
                                                      (Z))
                                              ],
                                                .))
                                          tmp
                                          =
                                          Apply
                                            ((74,
                                              Effect
                                                ([
                                                  Type
                                                    (OCaml.Effect.State.state,
                                                      Type
                                                        (Z))
                                                ],
                                                  .)),
                                              Variable
                                                ((74,
                                                  Effect
                                                    ([
                                                    ],
                                                      .
                                                        -[
                                                          Type
                                                            (OCaml.Effect.State.state,
                                                              Type
                                                                (Z))
                                                        ]->
                                                        .)),
                                                  OCaml.Effect.State.read),
                                              [
                                                Variable
                                                  ((74,
                                                    Effect
                                                      ([
                                                      ],
                                                        .)),
                                                    w)
                                              ])
                                          in
                                        Sequence
                                          ((75,
                                            Effect
                                              ([
                                                Type
                                                  (OCaml.Effect.State.state,
                                                    Type
                                                      (Z))
                                              ],
                                                .)),
                                            Apply
                                              ((75,
                                                Effect
                                                  ([
                                                    Type
                                                      (OCaml.Effect.State.state,
                                                        Type
                                                          (Z))
                                                  ],
                                                    .)),
                                                Variable
                                                  ((75,
                                                    Effect
                                                      ([
                                                      ],
                                                        .
                                                          ->
                                                          .
                                                            -[
                                                              Type
                                                                (OCaml.Effect.State.state,
                                                                  Type
                                                                    (Z))
                                                            ]->
                                                            .)),
                                                    OCaml.Effect.State.write),
                                                [
                                                  Variable
                                                    ((75,
                                                      Effect
                                                        ([
                                                        ],
                                                          .)),
                                                      w);
                                                  Apply
                                                    ((75,
                                                      Effect
                                                        ([
                                                          Type
                                                            (OCaml.Effect.State.state,
                                                              Type
                                                                (Z))
                                                        ],
                                                          .)),
                                                      Variable
                                                        ((75,
                                                          Effect
                                                            ([
                                                            ],
                                                              .
                                                                ->
                                                                .
                                                                  ->
                                                                  .)),
                                                          Z.mul),
                                                      [
                                                        Constant
                                                          ((75,
                                                            Effect
                                                              ([
                                                              ],
                                                                .)),
                                                            Int(2));
                                                        Apply
                                                          ((75,
                                                            Effect
                                                              ([
                                                                Type
                                                                  (OCaml.Effect.State.state,
                                                                    Type
                                                                      (Z))
                                                              ],
                                                                .)),
                                                            Variable
                                                              ((75,
                                                                Effect
                                                                  ([
                                                                  ],
                                                                    .
                                                                      -[
                                                                        Type
                                                                          (OCaml.Effect.State.state,
                                                                            Type
                                                                              (Z))
                                                                      ]->
                                                                      .)),
                                                                OCaml.Effect.State.read),
                                                            [
                                                              Variable
                                                                ((75,
                                                                  Effect
                                                                    ([
                                                                    ],
                                                                      .)),
                                                                  x)
                                                            ])
                                                      ])
                                                ]),
                                            Sequence
                                              ((76,
                                                Effect
                                                  ([
                                                    Type
                                                      (OCaml.Effect.State.state,
                                                        Type
                                                          (Z))
                                                  ],
                                                    .)),
                                                Apply
                                                  ((76,
                                                    Effect
                                                      ([
                                                        Type
                                                          (OCaml.Effect.State.state,
                                                            Type
                                                              (Z))
                                                      ],
                                                        .)),
                                                    Variable
                                                      ((76,
                                                        Effect
                                                          ([
                                                          ],
                                                            .
                                                              ->
                                                              .
                                                                -[
                                                                  Type
                                                                    (OCaml.Effect.State.state,
                                                                      Type
                                                                        (Z))
                                                                ]->
                                                                .)),
                                                        OCaml.Effect.State.write),
                                                    [
                                                      Variable
                                                        ((76,
                                                          Effect
                                                            ([
                                                            ],
                                                              .)),
                                                          x);
                                                      Variable
                                                        ((76,
                                                          Effect
                                                            ([
                                                            ],
                                                              .)),
                                                          tmp)
                                                    ]),
                                                Variable
                                                  ((77,
                                                    Effect
                                                      ([
                                                      ],
                                                        .)),
                                                    x))))))))
                    ])
                  in
                LetVar
                  (80,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .))
                  s =
                  Apply
                    ((80,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .)),
                      Variable
                        ((80,
                          Effect
                            ([
                            ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .)),
                          OCaml.Pervasives.ref),
                      [
                        Constant
                          ((80,
                            Effect
                              ([
                              ],
                                .)),
                            Int(110))
                      ])
                  in
                LetVar
                  (81,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .))
                  f1 =
                  Apply
                    ((81,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]->
                            .
                              -[
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ]->
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .)),
                      Variable
                        ((81,
                          Effect
                            ([
                            ],
                              .
                                ->
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .
                                    -[
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z))
                                    ]->
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ]->
                                      .)),
                          f),
                      [
                        Apply
                          ((81,
                            Effect
                              ([
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ],
                                .)),
                            Variable
                              ((81,
                                Effect
                                  ([
                                  ],
                                    .
                                      -[
                                        Type
                                          (OCaml.Effect.State.state,
                                            Type
                                              (Z))
                                      ]->
                                      .)),
                                OCaml.Pervasives.ref),
                            [
                              Constant
                                ((81,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  Int(5))
                            ])
                      ])
                  in
                LetVar
                  (82,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .))
                  f2 =
                  Apply
                    ((82,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]->
                            .
                              -[
                                Type
                                  (OCaml.Effect.State.state,
                                    Type
                                      (Z))
                              ]->
                              .)),
                      Variable
                        ((82,
                          Effect
                            ([
                            ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .
                                    -[
                                      Type
                                        (OCaml.Effect.State.state,
                                          Type
                                            (Z))
                                    ]->
                                    .)),
                          f1),
                      [
                        Constant
                          ((82,
                            Effect
                              ([
                              ],
                                .)),
                            Int(2))
                      ])
                  in
                LetVar
                  (83,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .))
                  f3 =
                  Apply
                    ((83,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]->
                            .)),
                      Variable
                        ((83,
                          Effect
                            ([
                            ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .)),
                          f2),
                      [
                        Constant
                          ((83,
                            Effect
                              ([
                              ],
                                .)),
                            Int(7))
                      ])
                  in
                LetVar
                  (84,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .))
                  f4 =
                  Apply
                    ((84,
                      Effect
                        ([
                          Type
                            (OCaml.Effect.State.state,
                              Type
                                (Z))
                        ],
                          .)),
                      Variable
                        ((84,
                          Effect
                            ([
                            ],
                              .
                                -[
                                  Type
                                    (OCaml.Effect.State.state,
                                      Type
                                        (Z))
                                ]->
                                .)),
                          f3),
                      [
                        Variable
                          ((84,
                            Effect
                              ([
                              ],
                                .)),
                            s)
                      ])
                  in
                Tuple
                  ((85,
                    Effect
                      ([
                        Type
                          (OCaml.Effect.State.state,
                            Type
                              (Z))
                      ],
                        .)),
                    Apply
                      ((85,
                        Effect
                          ([
                            Type
                              (OCaml.Effect.State.state,
                                Type
                                  (Z))
                          ],
                            .)),
                        Variable
                          ((85,
                            Effect
                              ([
                              ],
                                .
                                  -[
                                    Type
                                      (OCaml.Effect.State.state,
                                        Type
                                          (Z))
                                  ]->
                                  .)),
                            OCaml.Effect.State.read),
                        [
                          Variable
                            ((85,
                              Effect
                                ([
                                ],
                                  .)),
                              f4)
                        ]),
                    Variable
                      ((85,
                        Effect
                          ([
                          ],
                            .)),
                        s)))
            ]))
    ])

87
Value
  (non_rec, @.,
    [
      ((type_vars_test, [ A; B ],
        [
          (x, Type (OCaml.Effect.State.t, A));
          (y, Type (OCaml.Effect.State.t, B));
          (a, A);
          (b, B)
        ],
        Monad
          ([
            Type (OCaml.Effect.State.state, A);
            Type (OCaml.Effect.State.state, B)
          ], Type (unit))),
        Sequence
          ((88,
            Effect
              ([
                Type (OCaml.Effect.State.state, A);
                Type (OCaml.Effect.State.state, B)
              ], .)),
            Apply
              ((88, Effect ([ Type (OCaml.Effect.State.state, A) ], .)),
                Variable
                  ((88,
                    Effect
                      ([ ],
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  A)
                            ]-> .)),
                    OCaml.Effect.State.write),
                [
                  Variable ((88, Effect ([ ], .)), x);
                  Variable ((88, Effect ([ ], .)), a)
                ]),
            Apply
              ((89, Effect ([ Type (OCaml.Effect.State.state, B) ], .)),
                Variable
                  ((89,
                    Effect
                      ([ ],
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  B)
                            ]-> .)),
                    OCaml.Effect.State.write),
                [
                  Variable ((89, Effect ([ ], .)), y);
                  Variable ((89, Effect ([ ], .)), b)
                ])))
    ])

91
Value
  (non_rec, @.,
    [
      ((resolves_test1, [ A ],
        [ (x, Type (OCaml.Effect.State.t, A)); (a, A); (b, A) ],
        Monad ([ Type (OCaml.Effect.State.state, A) ], Type (unit))),
        Apply
          ((92, Effect ([ Type (OCaml.Effect.State.state, A) ], .)),
            Variable
              ((92,
                Effect
                  ([ ],
                    . ->
                      . ->
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  A);
                              Type
                                (OCaml.Effect.State.state,
                                  A)
                            ]-> .)), type_vars_test),
            [
              Variable ((92, Effect ([ ], .)), x);
              Variable ((92, Effect ([ ], .)), x);
              Variable ((92, Effect ([ ], .)), a);
              Variable ((92, Effect ([ ], .)), b)
            ]))
    ])

94
Value
  (non_rec, @.,
    [
      ((resolves_test2, [ A ],
        [
          (x, Type (OCaml.Effect.State.t, Type (Z)));
          (y, Type (OCaml.Effect.State.t, A));
          (a, Type (Z));
          (b, A)
        ],
        Monad
          ([
            Type (OCaml.Effect.State.state, A);
            Type (OCaml.Effect.State.state, Type (Z))
          ], Type (unit))),
        Apply
          ((95,
            Effect
              ([
                Type (OCaml.Effect.State.state, A);
                Type (OCaml.Effect.State.state, Type (Z))
              ], .)),
            Variable
              ((95,
                Effect
                  ([ ],
                    . ->
                      . ->
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (OCaml.Effect.State.state,
                                  A)
                            ]-> .)), type_vars_test),
            [
              Variable ((95, Effect ([ ], .)), x);
              Variable ((95, Effect ([ ], .)), y);
              Variable ((95, Effect ([ ], .)), a);
              Variable ((95, Effect ([ ], .)), b)
            ]))
    ])

97
Value
  (non_rec, @.,
    [
      ((resolves_test3, [ ],
        [
          (x, Type (OCaml.Effect.State.t, Type (Z)));
          (y, Type (OCaml.Effect.State.t, Type (Z)));
          (a, Type (Z));
          (b, Type (Z))
        ], Monad ([ Type (OCaml.Effect.State.state, Type (Z)) ], Type (unit))),
        Apply
          ((98, Effect ([ Type (OCaml.Effect.State.state, Type (Z)) ], .)),
            Variable
              ((98,
                Effect
                  ([ ],
                    . ->
                      . ->
                        . ->
                          .
                            -[
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (OCaml.Effect.State.state,
                                  Type
                                    (Z))
                            ]-> .)), type_vars_test),
            [
              Variable ((98, Effect ([ ], .)), x);
              Variable ((98, Effect ([ ], .)), y);
              Variable ((98, Effect ([ ], .)), a);
              Variable ((98, Effect ([ ], .)), b)
            ]))
    ])
