3
Value
  (rec, @coq_rec,
    [
      ((f_map, [ A; B ], [ (f, (A -> B)); (l, Type (list/3, A)) ],
        Type (list/3, B)),
        Match
          (4, Variable (4, l/0),
            [
              (Constructor ([]/3), Constructor (5, []/3));
              (Constructor (cons/3, x, l),
                Constructor
                  (6, cons/3,
                    Apply
                      (6,
                        Variable
                          (6,
                            f/0),
                        [
                          Variable
                            (6,
                              x/0)
                        ]),
                    Apply
                      (6,
                        Variable
                          (6,
                            f_map/0),
                        [
                          Variable
                            (6,
                              f/0);
                          Variable
                            (6,
                              l/0)
                        ])))
            ]))
    ])

9
Value
  (rec, @free_rec,
    [
      ((f_map2_rec, [ A; B ],
        [ (counter, Type (nat/3)); (f, (A -> B)); (l, Type (list/3, A)) ],
        Monad ([ NonTermination/3 ], Type (list/3, B))),
        Match
          (?, Variable (?, counter/0),
            [
              (Constructor (O/3),
                Apply
                  (?,
                    Variable
                      (?,
                        not_terminated/3),
                    [
                      Tuple
                        (?)
                    ]));
              (Constructor (S/3, counter),
                Match
                  (10,
                    Variable
                      (10,
                        l/0),
                    [
                      (Constructor
                        ([]/3),
                        Return
                          (?,
                            Constructor
                              (11,
                                []/3)));
                      (Constructor
                        (cons/3,
                          x,
                          l),
                        Bind
                          (?,
                            Apply
                              (12,
                                Apply
                                  (?,
                                    Variable
                                      (?,
                                        f_map2_rec/0),
                                    [
                                      Variable
                                        (?,
                                          counter/0)
                                    ]),
                                [
                                  Variable
                                    (12,
                                      f/0);
                                  Variable
                                    (12,
                                      l/0)
                                ]),
                            Some
                              x_1,
                            Return
                              (?,
                                Constructor
                                  (12,
                                    cons/3,
                                    Apply
                                      (12,
                                        Variable
                                          (12,
                                            f/0),
                                        [
                                          Variable
                                            (12,
                                              x/0)
                                        ]),
                                    Variable
                                      (?,
                                        x_1/0)))))
                    ]))
            ]))
    ])

9
Value
  (non_rec, @.,
    [
      ((f_map2, [ A; B ], [ (f, (A -> B)); (l, Type (list/3, A)) ],
        Monad ([ Counter/3; NonTermination/3 ], Type (list/3, B))),
        Bind
          (?,
            Lift
              (?, [ Counter/3 ], [ Counter/3; NonTermination/3 ],
                Apply (?, Variable (?, read_counter/3), [ Tuple (?) ])),
            Some x,
            Lift
              (?, [ NonTermination/3 ], [ Counter/3; NonTermination/3 ],
                Apply
                  (?, Variable (?, f_map2_rec/0),
                    [
                      Variable (?, x/0);
                      Variable (?, f/0);
                      Variable (?, l/0)
                    ]))))
    ])

15
Value
  (non_rec, @.,
    [
      ((n, [ ], [ ], Type (Z/3)),
        LetFun 16
          (rec, @coq_rec,
            [
              ((sum_coq_rec, [ ], [ (l, Type (list/3, Type (Z/3))) ],
                Type (Z/3)),
                Match
                  (17,
                    Variable
                      (17,
                        l/0),
                    [
                      (Constructor
                        ([]/3),
                        Constant
                          (18,
                            Int(0)));
                      (Constructor
                        (cons/3,
                          x,
                          l),
                        Apply
                          (19,
                            Variable
                              (19,
                                Z.add/3),
                            [
                              Variable
                                (19,
                                  x/0);
                              Apply
                                (19,
                                  Variable
                                    (19,
                                      sum_coq_rec/0),
                                  [
                                    Variable
                                      (19,
                                        l/0)
                                  ])
                            ]))
                    ]))
            ]) in
        Apply
          (20, Variable (20, sum_coq_rec/0),
            [
              Constructor
                (20, cons/3, Constant (20, Int(1)),
                  Constructor
                    (20,
                      cons/3,
                      Constant
                        (20,
                          Int(2)),
                      Constructor
                        (20,
                          cons/3,
                          Constant
                            (20,
                              Int(3)),
                          Constructor
                            (20,
                              []/3))))
            ]))
    ])

22
Value
  (non_rec, @.,
    [
      ((n2, [ A ], [ (x, A) ],
        Monad ([ Counter/3; NonTermination/3 ], Type (Z/3))),
        Match
          (?, Variable (?, x/0),
            [
              (Any,
                LetFun 23
                  (rec, @.,
                    [
                      ((sum_rec,
                        [
                        ],
                        [
                          (counter,
                            Type
                              (nat/3));
                          (l,
                            Type
                              (list/3,
                                Type
                                  (Z/3)))
                        ],
                        Monad
                          ([
                            NonTermination/3
                          ],
                            Type
                              (Z/3))),
                        Match
                          (?,
                            Variable
                              (?,
                                counter/0),
                            [
                              (Constructor
                                (O/3),
                                Apply
                                  (?,
                                    Variable
                                      (?,
                                        not_terminated/3),
                                    [
                                      Tuple
                                        (?)
                                    ]));
                              (Constructor
                                (S/3,
                                  counter),
                                Match
                                  (24,
                                    Variable
                                      (24,
                                        l/0),
                                    [
                                      (Constructor
                                        ([]/3),
                                        Return
                                          (?,
                                            Constant
                                              (25,
                                                Int(0))));
                                      (Constructor
                                        (cons/3,
                                          x,
                                          l),
                                        Bind
                                          (?,
                                            Apply
                                              (26,
                                                Apply
                                                  (?,
                                                    Variable
                                                      (?,
                                                        sum_rec/0),
                                                    [
                                                      Variable
                                                        (?,
                                                          counter/0)
                                                    ]),
                                                [
                                                  Variable
                                                    (26,
                                                      l/0)
                                                ]),
                                            Some
                                              x_1,
                                            Return
                                              (?,
                                                Apply
                                                  (26,
                                                    Variable
                                                      (26,
                                                        Z.add/3),
                                                    [
                                                      Variable
                                                        (26,
                                                          x/0);
                                                      Variable
                                                        (?,
                                                          x_1/0)
                                                    ]))))
                                    ]))
                            ]))
                    ])
                  in
                LetFun 23
                  (non_rec, @.,
                    [
                      ((sum,
                        [
                        ],
                        [
                          (l,
                            Type
                              (list/3,
                                Type
                                  (Z/3)))
                        ],
                        Monad
                          ([
                            Counter/3;
                            NonTermination/3
                          ],
                            Type
                              (Z/3))),
                        Bind
                          (?,
                            Lift
                              (?,
                                [
                                  Counter/3
                                ],
                                [
                                  Counter/3;
                                  NonTermination/3
                                ],
                                Apply
                                  (?,
                                    Variable
                                      (?,
                                        read_counter/3),
                                    [
                                      Tuple
                                        (?)
                                    ])),
                            Some
                              x_1,
                            Lift
                              (?,
                                [
                                  NonTermination/3
                                ],
                                [
                                  Counter/3;
                                  NonTermination/3
                                ],
                                Apply
                                  (?,
                                    Variable
                                      (?,
                                        sum_rec/0),
                                    [
                                      Variable
                                        (?,
                                          x_1/0);
                                      Variable
                                        (?,
                                          l/0)
                                    ]))))
                    ])
                  in
                Apply
                  (27,
                    Variable
                      (27,
                        sum/0),
                    [
                      Constructor
                        (27,
                          cons/3,
                          Constant
                            (27,
                              Int(1)),
                          Constructor
                            (27,
                              cons/3,
                              Constant
                                (27,
                                  Int(2)),
                              Constructor
                                (27,
                                  cons/3,
                                  Constant
                                    (27,
                                      Int(3)),
                                  Constructor
                                    (27,
                                      []/3))))
                    ]))
            ]))
    ])
