3
Value
  (rec, @.,
    [
      ((sums_rec, [ ],
        [ (counter, Type (nat)); (ls, Type (list, Type (list, Type (Z)))) ],
        Monad
          ([ Type (Counter); Type (NonTermination) ], Type (list, Type (Z)))),
        Match
          ((?, Effect ([ Type (Counter); Type (NonTermination) ], .)),
            Variable ((?, Effect ([ ], .)), Ex20/counter),
            [
              (Constructor (O),
                Apply
                  ((?,
                    Effect
                      ([
                        Type
                          (NonTermination)
                      ],
                        .)),
                    Variable
                      ((?,
                        Effect
                          ([
                          ],
                            .
                              -[
                                Type
                                  (NonTermination)
                              ]->
                              .)),
                        not_terminated),
                    [
                      Tuple
                        ((?,
                          Effect
                            ([
                            ],
                              .)))
                    ]));
              (Constructor (S, counter),
                LetFun
                  (4,
                    Effect
                      ([
                        Type
                          (Counter);
                        Type
                          (NonTermination)
                      ],
                        .))
                  (rec, @.,
                    [
                      ((sum_rec,
                        [
                        ],
                        [
                          (counter_1,
                            Type
                              (nat));
                          (xs,
                            Type
                              (list,
                                Type
                                  (Z)))
                        ],
                        Monad
                          ([
                            Type
                              (Counter);
                            Type
                              (NonTermination)
                          ],
                            Type
                              (Z))),
                        Match
                          ((?,
                            Effect
                              ([
                                Type
                                  (Counter);
                                Type
                                  (NonTermination)
                              ],
                                .)),
                            Variable
                              ((?,
                                Effect
                                  ([
                                  ],
                                    .)),
                                Ex20/counter_1),
                            [
                              (Constructor
                                (O),
                                Apply
                                  ((?,
                                    Effect
                                      ([
                                        Type
                                          (NonTermination)
                                      ],
                                        .)),
                                    Variable
                                      ((?,
                                        Effect
                                          ([
                                          ],
                                            .
                                              -[
                                                Type
                                                  (NonTermination)
                                              ]->
                                              .)),
                                        not_terminated),
                                    [
                                      Tuple
                                        ((?,
                                          Effect
                                            ([
                                            ],
                                              .)))
                                    ]));
                              (Constructor
                                (S,
                                  counter_1),
                                Match
                                  ((5,
                                    Effect
                                      ([
                                        Type
                                          (Counter);
                                        Type
                                          (NonTermination)
                                      ],
                                        .)),
                                    Variable
                                      ((5,
                                        Effect
                                          ([
                                          ],
                                            .)),
                                        Ex20/xs),
                                    [
                                      (Constructor
                                        ([]),
                                        Constant
                                          ((6,
                                            Effect
                                              ([
                                              ],
                                                .)),
                                            Int(0)));
                                      (Constructor
                                        (cons,
                                          x,
                                          xs),
                                        IfThenElse
                                          ((8,
                                            Effect
                                              ([
                                                Type
                                                  (Counter);
                                                Type
                                                  (NonTermination)
                                              ],
                                                .)),
                                            Apply
                                              ((8,
                                                Effect
                                                  ([
                                                  ],
                                                    .)),
                                                Variable
                                                  ((8,
                                                    Effect
                                                      ([
                                                      ],
                                                        .
                                                          ->
                                                          .
                                                            ->
                                                            .)),
                                                    equiv_decb),
                                                [
                                                  Variable
                                                    ((8,
                                                      Effect
                                                        ([
                                                        ],
                                                          .)),
                                                      Ex20/x);
                                                  Constant
                                                    ((8,
                                                      Effect
                                                        ([
                                                        ],
                                                          .)),
                                                      Int(12))
                                                ]),
                                            Match
                                              ((9,
                                                Effect
                                                  ([
                                                    Type
                                                      (Counter);
                                                    Type
                                                      (NonTermination)
                                                  ],
                                                    .)),
                                                Apply
                                                  ((9,
                                                    Effect
                                                      ([
                                                        Type
                                                          (Counter);
                                                        Type
                                                          (NonTermination)
                                                      ],
                                                        .)),
                                                    Apply
                                                      ((?,
                                                        Effect
                                                          ([
                                                          ],
                                                            .
                                                              -[
                                                                Type
                                                                  (Counter);
                                                                Type
                                                                  (NonTermination)
                                                              ]->
                                                              .)),
                                                        Variable
                                                          ((?,
                                                            Effect
                                                              ([
                                                              ],
                                                                .
                                                                  ->
                                                                  .
                                                                    -[
                                                                      Type
                                                                        (Counter);
                                                                      Type
                                                                        (NonTermination)
                                                                    ]->
                                                                    .)),
                                                            Ex20/sums_rec),
                                                        [
                                                          Variable
                                                            ((?,
                                                              Effect
                                                                ([
                                                                ],
                                                                  .)),
                                                              Ex20/counter)
                                                        ]),
                                                    [
                                                      Constructor
                                                        ((9,
                                                          Effect
                                                            ([
                                                            ],
                                                              .)),
                                                          cons,
                                                          Constructor
                                                            ((9,
                                                              Effect
                                                                ([
                                                                ],
                                                                  .)),
                                                              cons,
                                                              Constant
                                                                ((9,
                                                                  Effect
                                                                    ([
                                                                    ],
                                                                      .)),
                                                                  Int(13)),
                                                              Constructor
                                                                ((9,
                                                                  Effect
                                                                    ([
                                                                    ],
                                                                      .)),
                                                                  [])),
                                                          Constructor
                                                            ((9,
                                                              Effect
                                                                ([
                                                                ],
                                                                  .)),
                                                              []))
                                                    ]),
                                                [
                                                  (Constructor
                                                    (cons,
                                                      x,
                                                      Any),
                                                    Apply
                                                      ((10,
                                                        Effect
                                                          ([
                                                          ],
                                                            .)),
                                                        Variable
                                                          ((10,
                                                            Effect
                                                              ([
                                                              ],
                                                                .
                                                                  ->
                                                                  .
                                                                    ->
                                                                    .)),
                                                            Z.sub),
                                                        [
                                                          Variable
                                                            ((10,
                                                              Effect
                                                                ([
                                                                ],
                                                                  .)),
                                                              Ex20/x);
                                                          Constant
                                                            ((10,
                                                              Effect
                                                                ([
                                                                ],
                                                                  .)),
                                                              Int(1))
                                                        ]));
                                                  (Any,
                                                    Constant
                                                      ((11,
                                                        Effect
                                                          ([
                                                          ],
                                                            .)),
                                                        Int(0)))
                                                ]),
                                            Apply
                                              ((13,
                                                Effect
                                                  ([
                                                    Type
                                                      (Counter);
                                                    Type
                                                      (NonTermination)
                                                  ],
                                                    .)),
                                                Variable
                                                  ((13,
                                                    Effect
                                                      ([
                                                      ],
                                                        .
                                                          ->
                                                          .
                                                            ->
                                                            .)),
                                                    Z.add),
                                                [
                                                  Variable
                                                    ((13,
                                                      Effect
                                                        ([
                                                        ],
                                                          .)),
                                                      Ex20/x);
                                                  Apply
                                                    ((13,
                                                      Effect
                                                        ([
                                                          Type
                                                            (Counter);
                                                          Type
                                                            (NonTermination)
                                                        ],
                                                          .)),
                                                      Apply
                                                        ((?,
                                                          Effect
                                                            ([
                                                            ],
                                                              .
                                                                -[
                                                                  Type
                                                                    (Counter);
                                                                  Type
                                                                    (NonTermination)
                                                                ]->
                                                                .)),
                                                          Variable
                                                            ((?,
                                                              Effect
                                                                ([
                                                                ],
                                                                  .
                                                                    ->
                                                                    .
                                                                      -[
                                                                        Type
                                                                          (Counter);
                                                                        Type
                                                                          (NonTermination)
                                                                      ]->
                                                                      .)),
                                                              Ex20/sum_rec),
                                                          [
                                                            Variable
                                                              ((?,
                                                                Effect
                                                                  ([
                                                                  ],
                                                                    .)),
                                                                Ex20/counter_1)
                                                          ]),
                                                      [
                                                        Variable
                                                          ((13,
                                                            Effect
                                                              ([
                                                              ],
                                                                .)),
                                                            Ex20/xs)
                                                      ])
                                                ])))
                                    ]))
                            ]))
                    ])
                  in
                LetFun
                  (4,
                    Effect
                      ([
                        Type
                          (Counter);
                        Type
                          (NonTermination)
                      ],
                        .))
                  (non_rec, @.,
                    [
                      ((sum,
                        [
                        ],
                        [
                          (xs,
                            Type
                              (list,
                                Type
                                  (Z)))
                        ],
                        Monad
                          ([
                            Type
                              (Counter);
                            Type
                              (NonTermination)
                          ],
                            Type
                              (Z))),
                        Apply
                          ((?,
                            Effect
                              ([
                                Type
                                  (Counter);
                                Type
                                  (NonTermination)
                              ],
                                .)),
                            Variable
                              ((?,
                                Effect
                                  ([
                                  ],
                                    .
                                      ->
                                      .
                                        -[
                                          Type
                                            (Counter);
                                          Type
                                            (NonTermination)
                                        ]->
                                        .)),
                                Ex20/sum_rec),
                            [
                              Apply
                                ((?,
                                  Effect
                                    ([
                                      Type
                                        (Counter)
                                    ],
                                      .)),
                                  Variable
                                    ((?,
                                      Effect
                                        ([
                                        ],
                                          .
                                            -[
                                              Type
                                                (Counter)
                                            ]->
                                            .)),
                                      read_counter),
                                  [
                                    Tuple
                                      ((?,
                                        Effect
                                          ([
                                          ],
                                            .)))
                                  ]);
                              Variable
                                ((?,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  Ex20/xs)
                            ]))
                    ])
                  in
                Match
                  ((14,
                    Effect
                      ([
                        Type
                          (Counter);
                        Type
                          (NonTermination)
                      ],
                        .)),
                    Variable
                      ((14,
                        Effect
                          ([
                          ],
                            .)),
                        Ex20/ls),
                    [
                      (Constructor
                        ([]),
                        Constructor
                          ((15,
                            Effect
                              ([
                              ],
                                .)),
                            []));
                      (Constructor
                        (cons,
                          xs,
                          ls),
                        Constructor
                          ((16,
                            Effect
                              ([
                                Type
                                  (Counter);
                                Type
                                  (NonTermination)
                              ],
                                .)),
                            cons,
                            Apply
                              ((16,
                                Effect
                                  ([
                                    Type
                                      (Counter);
                                    Type
                                      (NonTermination)
                                  ],
                                    .)),
                                Variable
                                  ((16,
                                    Effect
                                      ([
                                      ],
                                        .
                                          -[
                                            Type
                                              (Counter);
                                            Type
                                              (NonTermination)
                                          ]->
                                          .)),
                                    Ex20/sum),
                                [
                                  Variable
                                    ((16,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      Ex20/xs)
                                ]),
                            Apply
                              ((16,
                                Effect
                                  ([
                                    Type
                                      (Counter);
                                    Type
                                      (NonTermination)
                                  ],
                                    .)),
                                Apply
                                  ((?,
                                    Effect
                                      ([
                                      ],
                                        .
                                          -[
                                            Type
                                              (Counter);
                                            Type
                                              (NonTermination)
                                          ]->
                                          .)),
                                    Variable
                                      ((?,
                                        Effect
                                          ([
                                          ],
                                            .
                                              ->
                                              .
                                                -[
                                                  Type
                                                    (Counter);
                                                  Type
                                                    (NonTermination)
                                                ]->
                                                .)),
                                        Ex20/sums_rec),
                                    [
                                      Variable
                                        ((?,
                                          Effect
                                            ([
                                            ],
                                              .)),
                                          Ex20/counter)
                                    ]),
                                [
                                  Variable
                                    ((16,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      Ex20/ls)
                                ])))
                    ]))
            ]))
    ])

3
Value
  (non_rec, @.,
    [
      ((sums, [ ], [ (ls, Type (list, Type (list, Type (Z)))) ],
        Monad
          ([ Type (Counter); Type (NonTermination) ], Type (list, Type (Z)))),
        Apply
          ((?, Effect ([ Type (Counter); Type (NonTermination) ], .)),
            Variable
              ((?,
                Effect
                  ([ ],
                    . ->
                      .
                        -[
                          Type (Counter);
                          Type (NonTermination)
                        ]-> .)), Ex20/sums_rec),
            [
              Apply
                ((?, Effect ([ Type (Counter) ], .)),
                  Variable
                    ((?,
                      Effect
                        ([
                        ],
                          .
                            -[
                              Type
                                (Counter)
                            ]->
                            .)),
                      read_counter),
                  [
                    Tuple
                      ((?,
                        Effect
                          ([
                          ],
                            .)))
                  ]);
              Variable ((?, Effect ([ ], .)), Ex20/ls)
            ]))
    ])
