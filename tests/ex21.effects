3
Value
  (non_rec, @.,
    [
      ((f, [ A; B; C ], [ (x, A) ],
        Monad ([ Type (IO) ], (B -> Monad ([ Type (OCaml.Failure) ], C)))),
        Sequence
          ((4, Effect ([ Type (IO) ], . -[ Type (OCaml.Failure) ]-> .)),
            Apply
              ((4, Effect ([ Type (IO) ], .)),
                Variable
                  ((4, Effect ([ ], . -[ Type (IO) ]-> .)),
                    OCaml.Pervasives.print_string),
                [ Constant ((4, Effect ([ ], .)), String("Hi")) ]),
            Function
              ((5, Effect ([ ], . -[ Type (OCaml.Failure) ]-> .)), y,
                Apply
                  ((5, Effect ([ Type (OCaml.Failure) ], .)),
                    Variable
                      ((5,
                        Effect
                          ([ ],
                            . -[ Type (OCaml.Failure) ]->
                              .)),
                        OCaml.Pervasives.failwith),
                    [
                      Constant
                        ((5,
                          Effect
                            ([
                            ],
                              .)),
                          String("Bye"))
                    ]))))
    ])

7
Value
  (non_rec, @.,
    [
      ((r, [ A; B ], [ (x, A) ], Monad ([ Type (IO); Type (OCaml.Failure) ], B)),
        Match
          ((7, Effect ([ Type (IO); Type (OCaml.Failure) ], .)),
            Variable ((?, Effect ([ ], .)), x),
            [
              (Any,
                Apply
                  ((7,
                    Effect
                      ([
                        Type
                          (IO);
                        Type
                          (OCaml.Failure)
                      ],
                        .)),
                    Apply
                      ((7,
                        Effect
                          ([
                            Type
                              (IO)
                          ],
                            .
                              -[
                                Type
                                  (OCaml.Failure)
                              ]->
                              .)),
                        Variable
                          ((7,
                            Effect
                              ([
                              ],
                                .
                                  -[
                                    Type
                                      (IO)
                                  ]->
                                  .
                                    -[
                                      Type
                                        (OCaml.Failure)
                                    ]->
                                    .)),
                            f),
                        [
                          Constant
                            ((7,
                              Effect
                                ([
                                ],
                                  .)),
                              Int(1))
                        ]),
                    [
                      Constant
                        ((7,
                          Effect
                            ([
                            ],
                              .)),
                          Int(2))
                    ]))
            ]))
    ])
