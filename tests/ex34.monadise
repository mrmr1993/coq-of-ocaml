Require [ OCaml.List ]

3 Module Ord:
  4 Abstract (t, [ ])
  
  5
  Value
    (non_rec, @.,
      [
        ((compare, [ ], [ (x, Type (Ex34.Ord/t)) ],
          (Type (Ex34.Ord/t) -> Type (Z))),
          Match
            (5, Variable (?, Ex34.Ord/x),
              [
                (Any,
                  Function
                    (5,
                      x_1,
                      Match
                        (5,
                          Variable
                            (?,
                              Ex34.Ord/x_1),
                          [
                            (Any,
                              Constant
                                (5,
                                  Int(0)))
                          ])))
              ]))
      ])

8 Synonym (elt, [ ], Type (Ex34/Ord.t))

9
Inductive t:
  ([ ],
    [
      (Empty, [ ]);
      (Node, [ Type (Ex34/t); Type (Ex34/elt); Type (Ex34/t); Type (Z) ])
    ])

14
Value
  (non_rec, @.,
    [
      ((height, [ ], [ (x, Type (Ex34/t)) ], Type (Z)),
        Match
          (15, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Constant (15, Int(0)));
              (Constructor (Ex34/Node, Any, Any, Any, h),
                Variable (16, Ex34/h))
            ]))
    ])

23
Value
  (non_rec, @.,
    [
      ((create, [ ],
        [ (l, Type (Ex34/t)); (v, Type (Ex34/elt)); (r, Type (Ex34/t)) ],
        Type (Ex34/t)),
        LetVar ? hl =
          Match
            (24, Variable (24, Ex34/l),
              [
                (Constructor (Ex34/Empty), Constant (24, Int(0)));
                (Constructor (Ex34/Node, Any, Any, Any, h),
                  Variable (24, Ex34/h))
              ]) in
        LetVar ? hr =
          Match
            (25, Variable (25, Ex34/r),
              [
                (Constructor (Ex34/Empty), Constant (25, Int(0)));
                (Constructor (Ex34/Node, Any, Any, Any, h),
                  Variable (25, Ex34/h))
              ]) in
        Constructor
          (26, Ex34/Node, Variable (26, Ex34/l), Variable (26, Ex34/v),
            Variable (26, Ex34/r),
            IfThenElse
              (26,
                Apply
                  (26, Variable (26, OCaml/Pervasives.ge),
                    [
                      Variable (26, Ex34/hl);
                      Variable (26, Ex34/hr)
                    ]),
                Apply
                  (26, Variable (26, Z.add),
                    [
                      Variable (26, Ex34/hl);
                      Constant (26, Int(1))
                    ]),
                Apply
                  (26, Variable (26, Z.add),
                    [
                      Variable (26, Ex34/hr);
                      Constant (26, Int(1))
                    ]))))
    ])

33
Value
  (non_rec, @.,
    [
      ((bal, [ ],
        [ (l, Type (Ex34/t)); (v, Type (Ex34/elt)); (r, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/invalid_argument)) ],
            Type (Ex34/t))),
        LetVar ? hl =
          Match
            (34, Variable (34, Ex34/l),
              [
                (Constructor (Ex34/Empty), Constant (34, Int(0)));
                (Constructor (Ex34/Node, Any, Any, Any, h),
                  Variable (34, Ex34/h))
              ]) in
        LetVar ? hr =
          Match
            (35, Variable (35, Ex34/r),
              [
                (Constructor (Ex34/Empty), Constant (35, Int(0)));
                (Constructor (Ex34/Node, Any, Any, Any, h),
                  Variable (35, Ex34/h))
              ]) in
        IfThenElse
          (36,
            Apply
              (36, Variable (36, OCaml/Pervasives.gt),
                [
                  Variable (36, Ex34/hl);
                  Apply
                    (36,
                      Variable
                        (36,
                          Z.add),
                      [
                        Variable
                          (36,
                            Ex34/hr);
                        Constant
                          (36,
                            Int(2))
                      ])
                ]),
            Match
              (36, Variable (37, Ex34/l),
                [
                  (Constructor (Ex34/Empty),
                    Apply
                      (38,
                        Variable
                          (38,
                            OCaml/Pervasives.invalid_arg),
                        [
                          Constant
                            (38,
                              String("Set.bal"))
                        ]));
                  (Constructor (Ex34/Node, ll, lv, lr, Any),
                    IfThenElse
                      (40,
                        Apply
                          (40,
                            Variable
                              (40,
                                OCaml/Pervasives.ge),
                            [
                              Apply
                                (40,
                                  Variable
                                    (40,
                                      Ex34/height),
                                  [
                                    Variable
                                      (40,
                                        Ex34/ll)
                                  ]);
                              Apply
                                (40,
                                  Variable
                                    (40,
                                      Ex34/height),
                                  [
                                    Variable
                                      (40,
                                        Ex34/lr)
                                  ])
                            ]),
                        Return
                          (?,
                            Apply
                              (41,
                                Variable
                                  (41,
                                    Ex34/create),
                                [
                                  Variable
                                    (41,
                                      Ex34/ll);
                                  Variable
                                    (41,
                                      Ex34/lv);
                                  Apply
                                    (41,
                                      Variable
                                        (41,
                                          Ex34/create),
                                      [
                                        Variable
                                          (41,
                                            Ex34/lr);
                                        Variable
                                          (41,
                                            Ex34/v);
                                        Variable
                                          (41,
                                            Ex34/r)
                                      ])
                                ])),
                        Match
                          (42,
                            Variable
                              (43,
                                Ex34/lr),
                            [
                              (Constructor
                                (Ex34/Empty),
                                Apply
                                  (44,
                                    Variable
                                      (44,
                                        OCaml/Pervasives.invalid_arg),
                                    [
                                      Constant
                                        (44,
                                          String("Set.bal"))
                                    ]));
                              (Constructor
                                (Ex34/Node,
                                  lrl,
                                  lrv,
                                  lrr,
                                  Any),
                                Return
                                  (?,
                                    Apply
                                      (46,
                                        Variable
                                          (46,
                                            Ex34/create),
                                        [
                                          Apply
                                            (46,
                                              Variable
                                                (46,
                                                  Ex34/create),
                                              [
                                                Variable
                                                  (46,
                                                    Ex34/ll);
                                                Variable
                                                  (46,
                                                    Ex34/lv);
                                                Variable
                                                  (46,
                                                    Ex34/lrl)
                                              ]);
                                          Variable
                                            (46,
                                              Ex34/lrv);
                                          Apply
                                            (46,
                                              Variable
                                                (46,
                                                  Ex34/create),
                                              [
                                                Variable
                                                  (46,
                                                    Ex34/lrr);
                                                Variable
                                                  (46,
                                                    Ex34/v);
                                                Variable
                                                  (46,
                                                    Ex34/r)
                                              ])
                                        ])))
                            ])))
                ]),
            IfThenElse
              (48,
                Apply
                  (48, Variable (48, OCaml/Pervasives.gt),
                    [
                      Variable (48, Ex34/hr);
                      Apply
                        (48,
                          Variable
                            (48,
                              Z.add),
                          [
                            Variable
                              (48,
                                Ex34/hl);
                            Constant
                              (48,
                                Int(2))
                          ])
                    ]),
                Match
                  (48, Variable (49, Ex34/r),
                    [
                      (Constructor (Ex34/Empty),
                        Apply
                          (50,
                            Variable
                              (50,
                                OCaml/Pervasives.invalid_arg),
                            [
                              Constant
                                (50,
                                  String("Set.bal"))
                            ]));
                      (Constructor (Ex34/Node, rl, rv, rr, Any),
                        IfThenElse
                          (52,
                            Apply
                              (52,
                                Variable
                                  (52,
                                    OCaml/Pervasives.ge),
                                [
                                  Apply
                                    (52,
                                      Variable
                                        (52,
                                          Ex34/height),
                                      [
                                        Variable
                                          (52,
                                            Ex34/rr)
                                      ]);
                                  Apply
                                    (52,
                                      Variable
                                        (52,
                                          Ex34/height),
                                      [
                                        Variable
                                          (52,
                                            Ex34/rl)
                                      ])
                                ]),
                            Return
                              (?,
                                Apply
                                  (53,
                                    Variable
                                      (53,
                                        Ex34/create),
                                    [
                                      Apply
                                        (53,
                                          Variable
                                            (53,
                                              Ex34/create),
                                          [
                                            Variable
                                              (53,
                                                Ex34/l);
                                            Variable
                                              (53,
                                                Ex34/v);
                                            Variable
                                              (53,
                                                Ex34/rl)
                                          ]);
                                      Variable
                                        (53,
                                          Ex34/rv);
                                      Variable
                                        (53,
                                          Ex34/rr)
                                    ])),
                            Match
                              (54,
                                Variable
                                  (55,
                                    Ex34/rl),
                                [
                                  (Constructor
                                    (Ex34/Empty),
                                    Apply
                                      (56,
                                        Variable
                                          (56,
                                            OCaml/Pervasives.invalid_arg),
                                        [
                                          Constant
                                            (56,
                                              String("Set.bal"))
                                        ]));
                                  (Constructor
                                    (Ex34/Node,
                                      rll,
                                      rlv,
                                      rlr,
                                      Any),
                                    Return
                                      (?,
                                        Apply
                                          (58,
                                            Variable
                                              (58,
                                                Ex34/create),
                                            [
                                              Apply
                                                (58,
                                                  Variable
                                                    (58,
                                                      Ex34/create),
                                                  [
                                                    Variable
                                                      (58,
                                                        Ex34/l);
                                                    Variable
                                                      (58,
                                                        Ex34/v);
                                                    Variable
                                                      (58,
                                                        Ex34/rll)
                                                  ]);
                                              Variable
                                                (58,
                                                  Ex34/rlv);
                                              Apply
                                                (58,
                                                  Variable
                                                    (58,
                                                      Ex34/create),
                                                  [
                                                    Variable
                                                      (58,
                                                        Ex34/rlr);
                                                    Variable
                                                      (58,
                                                        Ex34/rv);
                                                    Variable
                                                      (58,
                                                        Ex34/rr)
                                                  ])
                                            ])))
                                ])))
                    ]),
                Return
                  (?,
                    Constructor
                      (61, Ex34/Node, Variable (61, Ex34/l),
                        Variable (61, Ex34/v),
                        Variable (61, Ex34/r),
                        IfThenElse
                          (61,
                            Apply
                              (61,
                                Variable
                                  (61,
                                    OCaml/Pervasives.ge),
                                [
                                  Variable
                                    (61,
                                      Ex34/hl);
                                  Variable
                                    (61,
                                      Ex34/hr)
                                ]),
                            Apply
                              (61, Variable (61, Z.add),
                                [
                                  Variable
                                    (61,
                                      Ex34/hl);
                                  Constant
                                    (61,
                                      Int(1))
                                ]),
                            Apply
                              (61, Variable (61, Z.add),
                                [
                                  Variable
                                    (61,
                                      Ex34/hr);
                                  Constant
                                    (61,
                                      Int(1))
                                ])))))))
    ])

65
Value
  (rec, @coq_rec,
    [
      ((add, [ ], [ (x, Type (Ex34/elt)); (x_1, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/invalid_argument)) ],
            Type (Ex34/t))),
        Match
          (66, Variable (?, Ex34/x_1),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Constructor
                      (66,
                        Ex34/Node,
                        Constructor
                          (66,
                            Ex34/Empty),
                        Variable
                          (66,
                            Ex34/x),
                        Constructor
                          (66,
                            Ex34/Empty),
                        Constant
                          (66,
                            Int(1)))));
              (Alias (Constructor (Ex34/Node, l, v, r, Any), t (= t_1)),
                LetVar ? c =
                  Apply
                    (68,
                      Variable
                        (68,
                          Ex34/Ord.compare),
                      [
                        Variable
                          (68,
                            Ex34/x);
                        Variable
                          (68,
                            Ex34/v)
                      ])
                  in
                IfThenElse
                  (69,
                    Apply
                      (69,
                        Variable
                          (69,
                            equiv_decb),
                        [
                          Variable
                            (69,
                              Ex34/c);
                          Constant
                            (69,
                              Int(0))
                        ]),
                    Return
                      (?,
                        Variable
                          (69,
                            Ex34/t_1)),
                    IfThenElse
                      (70,
                        Apply
                          (70,
                            Variable
                              (70,
                                OCaml/Pervasives.lt),
                            [
                              Variable
                                (70,
                                  Ex34/c);
                              Constant
                                (70,
                                  Int(0))
                            ]),
                        Bind
                          (?,
                            Apply
                              (70,
                                Variable
                                  (70,
                                    Ex34/add),
                                [
                                  Variable
                                    (70,
                                      Ex34/x);
                                  Variable
                                    (70,
                                      Ex34/l)
                                ]),
                            Some
                              x_2,
                            Apply
                              (70,
                                Variable
                                  (70,
                                    Ex34/bal),
                                [
                                  Variable
                                    (?,
                                      Ex34/x_2);
                                  Variable
                                    (70,
                                      Ex34/v);
                                  Variable
                                    (70,
                                      Ex34/r)
                                ])),
                        Bind
                          (?,
                            Apply
                              (70,
                                Variable
                                  (70,
                                    Ex34/add),
                                [
                                  Variable
                                    (70,
                                      Ex34/x);
                                  Variable
                                    (70,
                                      Ex34/r)
                                ]),
                            Some
                              x_2,
                            Apply
                              (70,
                                Variable
                                  (70,
                                    Ex34/bal),
                                [
                                  Variable
                                    (70,
                                      Ex34/l);
                                  Variable
                                    (70,
                                      Ex34/v);
                                  Variable
                                    (?,
                                      Ex34/x_2)
                                ])))))
            ]))
    ])

73
Value
  (non_rec, @.,
    [
      ((singleton, [ ], [ (x, Type (Ex34/elt)) ], Type (Ex34/t)),
        Constructor
          (73, Ex34/Node, Constructor (73, Ex34/Empty),
            Variable (73, Ex34/x), Constructor (73, Ex34/Empty),
            Constant (73, Int(1))))
    ])

82
Value
  (rec, @coq_rec,
    [
      ((add_min_element, [ ], [ (v, Type (Ex34/elt)); (x, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/invalid_argument)) ],
            Type (Ex34/t))),
        Match
          (83, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Apply
                      (83,
                        Variable
                          (83,
                            Ex34/singleton),
                        [
                          Variable
                            (83,
                              Ex34/v)
                        ])));
              (Constructor (Ex34/Node, l, x, r, h),
                Bind
                  (?,
                    Apply
                      (85,
                        Variable
                          (85,
                            Ex34/add_min_element),
                        [
                          Variable
                            (85,
                              Ex34/v);
                          Variable
                            (85,
                              Ex34/l)
                        ]),
                    Some
                      x_1,
                    Apply
                      (85,
                        Variable
                          (85,
                            Ex34/bal),
                        [
                          Variable
                            (?,
                              Ex34/x_1);
                          Variable
                            (85,
                              Ex34/x);
                          Variable
                            (85,
                              Ex34/r)
                        ])))
            ]))
    ])

88
Value
  (rec, @coq_rec,
    [
      ((add_max_element, [ ], [ (v, Type (Ex34/elt)); (x, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/invalid_argument)) ],
            Type (Ex34/t))),
        Match
          (89, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Apply
                      (89,
                        Variable
                          (89,
                            Ex34/singleton),
                        [
                          Variable
                            (89,
                              Ex34/v)
                        ])));
              (Constructor (Ex34/Node, l, x, r, h),
                Bind
                  (?,
                    Apply
                      (91,
                        Variable
                          (91,
                            Ex34/add_max_element),
                        [
                          Variable
                            (91,
                              Ex34/v);
                          Variable
                            (91,
                              Ex34/r)
                        ]),
                    Some
                      x_1,
                    Apply
                      (91,
                        Variable
                          (91,
                            Ex34/bal),
                        [
                          Variable
                            (91,
                              Ex34/l);
                          Variable
                            (91,
                              Ex34/x);
                          Variable
                            (?,
                              Ex34/x_1)
                        ])))
            ]))
    ])

97
Value
  (rec, @.,
    [
      ((join_rec, [ ],
        [
          (counter, Type (nat));
          (l, Type (Ex34/t));
          (v, Type (Ex34/elt));
          (r, Type (Ex34/t))
        ],
        Monad
          ([
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument))
          ], Type (Ex34/t))),
        Match
          (?, Variable (?, Ex34/counter),
            [
              (Constructor (O),
                Lift
                  (?,
                    [
                      Type
                        (NonTermination)
                    ],
                    [
                      Type
                        (NonTermination);
                      Type
                        (OCaml/exception,
                          Type
                            (OCaml/invalid_argument))
                    ],
                    Apply
                      (?,
                        Variable
                          (?,
                            not_terminated),
                        [
                          Tuple
                            (?)
                        ])));
              (Constructor (S, counter),
                Match
                  (98,
                    Tuple
                      (98,
                        Variable
                          (98,
                            Ex34/l),
                        Variable
                          (98,
                            Ex34/r)),
                    [
                      (Tuple
                        (Constructor
                          (Ex34/Empty),
                          Any),
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            [
                              Type
                                (NonTermination);
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            Apply
                              (99,
                                Variable
                                  (99,
                                    Ex34/add_min_element),
                                [
                                  Variable
                                    (99,
                                      Ex34/v);
                                  Variable
                                    (99,
                                      Ex34/r)
                                ])));
                      (Tuple
                        (Any,
                          Constructor
                            (Ex34/Empty)),
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            [
                              Type
                                (NonTermination);
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            Apply
                              (100,
                                Variable
                                  (100,
                                    Ex34/add_max_element),
                                [
                                  Variable
                                    (100,
                                      Ex34/v);
                                  Variable
                                    (100,
                                      Ex34/l)
                                ])));
                      (Tuple
                        (Constructor
                          (Ex34/Node,
                            ll,
                            lv,
                            lr,
                            lh),
                          Constructor
                            (Ex34/Node,
                              rl,
                              rv,
                              rr,
                              rh)),
                        IfThenElse
                          (102,
                            Apply
                              (102,
                                Variable
                                  (102,
                                    OCaml/Pervasives.gt),
                                [
                                  Variable
                                    (102,
                                      Ex34/lh);
                                  Apply
                                    (102,
                                      Variable
                                        (102,
                                          Z.add),
                                      [
                                        Variable
                                          (102,
                                            Ex34/rh);
                                        Constant
                                          (102,
                                            Int(2))
                                      ])
                                ]),
                            Bind
                              (?,
                                Apply
                                  (102,
                                    Apply
                                      (?,
                                        Variable
                                          (?,
                                            Ex34/join_rec),
                                        [
                                          Variable
                                            (?,
                                              Ex34/counter)
                                        ]),
                                    [
                                      Variable
                                        (102,
                                          Ex34/lr);
                                      Variable
                                        (102,
                                          Ex34/v);
                                      Variable
                                        (102,
                                          Ex34/r)
                                    ]),
                                Some
                                  x,
                                Lift
                                  (?,
                                    [
                                      Type
                                        (OCaml/exception,
                                          Type
                                            (OCaml/invalid_argument))
                                    ],
                                    [
                                      Type
                                        (NonTermination);
                                      Type
                                        (OCaml/exception,
                                          Type
                                            (OCaml/invalid_argument))
                                    ],
                                    Apply
                                      (102,
                                        Variable
                                          (102,
                                            Ex34/bal),
                                        [
                                          Variable
                                            (102,
                                              Ex34/ll);
                                          Variable
                                            (102,
                                              Ex34/lv);
                                          Variable
                                            (?,
                                              Ex34/x)
                                        ]))),
                            IfThenElse
                              (103,
                                Apply
                                  (103,
                                    Variable
                                      (103,
                                        OCaml/Pervasives.gt),
                                    [
                                      Variable
                                        (103,
                                          Ex34/rh);
                                      Apply
                                        (103,
                                          Variable
                                            (103,
                                              Z.add),
                                          [
                                            Variable
                                              (103,
                                                Ex34/lh);
                                            Constant
                                              (103,
                                                Int(2))
                                          ])
                                    ]),
                                Bind
                                  (?,
                                    Apply
                                      (103,
                                        Apply
                                          (?,
                                            Variable
                                              (?,
                                                Ex34/join_rec),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/counter)
                                            ]),
                                        [
                                          Variable
                                            (103,
                                              Ex34/l);
                                          Variable
                                            (103,
                                              Ex34/v);
                                          Variable
                                            (103,
                                              Ex34/rl)
                                        ]),
                                    Some
                                      x,
                                    Lift
                                      (?,
                                        [
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/invalid_argument))
                                        ],
                                        [
                                          Type
                                            (NonTermination);
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/invalid_argument))
                                        ],
                                        Apply
                                          (103,
                                            Variable
                                              (103,
                                                Ex34/bal),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/x);
                                              Variable
                                                (103,
                                                  Ex34/rv);
                                              Variable
                                                (103,
                                                  Ex34/rr)
                                            ]))),
                                Return
                                  (?,
                                    Apply
                                      (104,
                                        Variable
                                          (104,
                                            Ex34/create),
                                        [
                                          Variable
                                            (104,
                                              Ex34/l);
                                          Variable
                                            (104,
                                              Ex34/v);
                                          Variable
                                            (104,
                                              Ex34/r)
                                        ])))))
                    ]))
            ]))
    ])

97
Value
  (non_rec, @.,
    [
      ((join, [ ],
        [ (l, Type (Ex34/t)); (v, Type (Ex34/elt)); (r, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument))
          ], Type (Ex34/t))),
        Bind
          (?,
            Lift
              (?, [ Type (Counter) ],
                [
                  Type (Counter);
                  Type (NonTermination);
                  Type
                    (OCaml/exception,
                      Type
                        (OCaml/invalid_argument))
                ],
                Apply (?, Variable (?, read_counter), [ Tuple (?) ])),
            Some x,
            Lift
              (?,
                [
                  Type (NonTermination);
                  Type
                    (OCaml/exception,
                      Type
                        (OCaml/invalid_argument))
                ],
                [
                  Type (Counter);
                  Type (NonTermination);
                  Type
                    (OCaml/exception,
                      Type
                        (OCaml/invalid_argument))
                ],
                Apply
                  (?, Variable (?, Ex34/join_rec),
                    [
                      Variable (?, Ex34/x);
                      Variable (?, Ex34/l);
                      Variable (?, Ex34/v);
                      Variable (?, Ex34/r)
                    ]))))
    ])

108
Value
  (rec, @coq_rec,
    [
      ((min_elt, [ ], [ (x, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/not_found)) ],
            Type (Ex34/elt))),
        Match
          (109, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Apply
                  (109,
                    Variable
                      (109,
                        OCaml/Pervasives.raise),
                    [
                      Constructor
                        (109,
                          OCaml/Not_found,
                          Tuple
                            (?))
                    ]));
              (Constructor
                (Ex34/Node, Constructor (Ex34/Empty), v,
                  r, Any),
                Return (?, Variable (110, Ex34/v)));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (111,
                    Variable
                      (111,
                        Ex34/min_elt),
                    [
                      Variable
                        (111,
                          Ex34/l)
                    ]))
            ]))
    ])

114
Value
  (rec, @coq_rec,
    [
      ((max_elt, [ ], [ (x, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/not_found)) ],
            Type (Ex34/elt))),
        Match
          (115, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Apply
                  (115,
                    Variable
                      (115,
                        OCaml/Pervasives.raise),
                    [
                      Constructor
                        (115,
                          OCaml/Not_found,
                          Tuple
                            (?))
                    ]));
              (Constructor
                (Ex34/Node, l, v,
                  Constructor
                    (Ex34/Empty),
                  Any),
                Return (?, Variable (116, Ex34/v)));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (117,
                    Variable
                      (117,
                        Ex34/max_elt),
                    [
                      Variable
                        (117,
                          Ex34/r)
                    ]))
            ]))
    ])

122
Value
  (rec, @coq_rec,
    [
      ((remove_min_elt, [ ], [ (x, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/invalid_argument)) ],
            Type (Ex34/t))),
        Match
          (123, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Apply
                  (123,
                    Variable
                      (123,
                        OCaml/Pervasives.invalid_arg),
                    [
                      Constant
                        (123,
                          String("Set.remove_min_elt"))
                    ]));
              (Constructor
                (Ex34/Node, Constructor (Ex34/Empty), v,
                  r, Any),
                Return (?, Variable (124, Ex34/r)));
              (Constructor (Ex34/Node, l, v, r, Any),
                Bind
                  (?,
                    Apply
                      (125,
                        Variable
                          (125,
                            Ex34/remove_min_elt),
                        [
                          Variable
                            (125,
                              Ex34/l)
                        ]),
                    Some
                      x_1,
                    Apply
                      (125,
                        Variable
                          (125,
                            Ex34/bal),
                        [
                          Variable
                            (?,
                              Ex34/x_1);
                          Variable
                            (125,
                              Ex34/v);
                          Variable
                            (125,
                              Ex34/r)
                        ])))
            ]))
    ])

132
Value
  (non_rec, @.,
    [
      ((merge, [ ], [ (t1, Type (Ex34/t)); (t2, Type (Ex34/t)) ],
        Monad
          ([
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], Type (Ex34/t))),
        Match
          (133,
            Tuple (133, Variable (133, Ex34/t1), Variable (133, Ex34/t2)),
            [
              (Tuple (Constructor (Ex34/Empty), t (= t_1)),
                Return (?, Variable (134, Ex34/t_1)));
              (Tuple (t (= t_1), Constructor (Ex34/Empty)),
                Return (?, Variable (135, Ex34/t_1)));
              (Tuple (Any, Any),
                Bind
                  (?,
                    Lift
                      (?,
                        [
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/not_found))
                        ],
                        [
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/invalid_argument));
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/not_found))
                        ],
                        Apply
                          (136,
                            Variable
                              (136,
                                Ex34/min_elt),
                            [
                              Variable
                                (136,
                                  Ex34/t2)
                            ])),
                    Some
                      x,
                    Bind
                      (?,
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument));
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/not_found))
                            ],
                            Apply
                              (136,
                                Variable
                                  (136,
                                    Ex34/remove_min_elt),
                                [
                                  Variable
                                    (136,
                                      Ex34/t2)
                                ])),
                        Some
                          x_1,
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument));
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/not_found))
                            ],
                            Apply
                              (136,
                                Variable
                                  (136,
                                    Ex34/bal),
                                [
                                  Variable
                                    (136,
                                      Ex34/t1);
                                  Variable
                                    (?,
                                      Ex34/x);
                                  Variable
                                    (?,
                                      Ex34/x_1)
                                ])))))
            ]))
    ])

142
Value
  (non_rec, @.,
    [
      ((concat, [ ], [ (t1, Type (Ex34/t)); (t2, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], Type (Ex34/t))),
        Match
          (143,
            Tuple (143, Variable (143, Ex34/t1), Variable (143, Ex34/t2)),
            [
              (Tuple (Constructor (Ex34/Empty), t (= t_1)),
                Return (?, Variable (144, Ex34/t_1)));
              (Tuple (t (= t_1), Constructor (Ex34/Empty)),
                Return (?, Variable (145, Ex34/t_1)));
              (Tuple (Any, Any),
                Bind
                  (?,
                    Lift
                      (?,
                        [
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/not_found))
                        ],
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/invalid_argument));
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/not_found))
                        ],
                        Apply
                          (146,
                            Variable
                              (146,
                                Ex34/min_elt),
                            [
                              Variable
                                (146,
                                  Ex34/t2)
                            ])),
                    Some
                      x,
                    Bind
                      (?,
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            [
                              Type
                                (Counter);
                              Type
                                (NonTermination);
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument));
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/not_found))
                            ],
                            Apply
                              (146,
                                Variable
                                  (146,
                                    Ex34/remove_min_elt),
                                [
                                  Variable
                                    (146,
                                      Ex34/t2)
                                ])),
                        Some
                          x_1,
                        Lift
                          (?,
                            [
                              Type
                                (Counter);
                              Type
                                (NonTermination);
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument))
                            ],
                            [
                              Type
                                (Counter);
                              Type
                                (NonTermination);
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/invalid_argument));
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/not_found))
                            ],
                            Apply
                              (146,
                                Variable
                                  (146,
                                    Ex34/join),
                                [
                                  Variable
                                    (146,
                                      Ex34/t1);
                                  Variable
                                    (?,
                                      Ex34/x);
                                  Variable
                                    (?,
                                      Ex34/x_1)
                                ])))))
            ]))
    ])

154
Value
  (rec, @coq_rec,
    [
      ((split, [ ], [ (x, Type (Ex34/Ord.t)); (x_1, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument))
          ], (Type (Ex34/t) * Type (bool) * Type (Ex34/t)))),
        Match
          (155, Variable (?, Ex34/x_1),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Tuple
                      (156,
                        Constructor
                          (156,
                            Ex34/Empty),
                        Constructor
                          (156,
                            false),
                        Constructor
                          (156,
                            Ex34/Empty))));
              (Constructor (Ex34/Node, l, v, r, Any),
                LetVar ? c =
                  Apply
                    (158,
                      Variable
                        (158,
                          Ex34/Ord.compare),
                      [
                        Variable
                          (158,
                            Ex34/x);
                        Variable
                          (158,
                            Ex34/v)
                      ])
                  in
                IfThenElse
                  (159,
                    Apply
                      (159,
                        Variable
                          (159,
                            equiv_decb),
                        [
                          Variable
                            (159,
                              Ex34/c);
                          Constant
                            (159,
                              Int(0))
                        ]),
                    Return
                      (?,
                        Tuple
                          (159,
                            Variable
                              (159,
                                Ex34/l),
                            Constructor
                              (159,
                                true),
                            Variable
                              (159,
                                Ex34/r))),
                    IfThenElse
                      (160,
                        Apply
                          (160,
                            Variable
                              (160,
                                OCaml/Pervasives.lt),
                            [
                              Variable
                                (160,
                                  Ex34/c);
                              Constant
                                (160,
                                  Int(0))
                            ]),
                        Bind
                          (?,
                            Apply
                              (161,
                                Variable
                                  (161,
                                    Ex34/split),
                                [
                                  Variable
                                    (161,
                                      Ex34/x);
                                  Variable
                                    (161,
                                      Ex34/l)
                                ]),
                            Some
                              x_2,
                            Match
                              (161,
                                Variable
                                  (?,
                                    Ex34/x_2),
                                [
                                  (Tuple
                                    (ll,
                                      pres,
                                      rl),
                                    Bind
                                      (?,
                                        Apply
                                          (161,
                                            Variable
                                              (161,
                                                Ex34/join),
                                            [
                                              Variable
                                                (161,
                                                  Ex34/rl);
                                              Variable
                                                (161,
                                                  Ex34/v);
                                              Variable
                                                (161,
                                                  Ex34/r)
                                            ]),
                                        Some
                                          x_2,
                                        Return
                                          (?,
                                            Tuple
                                              (161,
                                                Variable
                                                  (161,
                                                    Ex34/ll),
                                                Variable
                                                  (161,
                                                    Ex34/pres),
                                                Variable
                                                  (?,
                                                    Ex34/x_2)))))
                                ])),
                        Bind
                          (?,
                            Apply
                              (163,
                                Variable
                                  (163,
                                    Ex34/split),
                                [
                                  Variable
                                    (163,
                                      Ex34/x);
                                  Variable
                                    (163,
                                      Ex34/r)
                                ]),
                            Some
                              x_2,
                            Match
                              (163,
                                Variable
                                  (?,
                                    Ex34/x_2),
                                [
                                  (Tuple
                                    (lr,
                                      pres,
                                      rr),
                                    Bind
                                      (?,
                                        Apply
                                          (163,
                                            Variable
                                              (163,
                                                Ex34/join),
                                            [
                                              Variable
                                                (163,
                                                  Ex34/l);
                                              Variable
                                                (163,
                                                  Ex34/v);
                                              Variable
                                                (163,
                                                  Ex34/lr)
                                            ]),
                                        Some
                                          x_2,
                                        Return
                                          (?,
                                            Tuple
                                              (163,
                                                Variable
                                                  (?,
                                                    Ex34/x_2),
                                                Variable
                                                  (163,
                                                    Ex34/pres),
                                                Variable
                                                  (163,
                                                    Ex34/rr)))))
                                ])))))
            ]))
    ])

168
Value
  (non_rec, @.,
    [ ((empty, [ ], [ ], Type (Ex34/t)), Constructor (168, Ex34/Empty)) ])

170
Value
  (non_rec, @.,
    [
      ((is_empty, [ ], [ (x, Type (Ex34/t)) ], Type (bool)),
        Match
          (170, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Constructor (170, true));
              (Any, Constructor (170, false))
            ]))
    ])

172
Value
  (rec, @coq_rec,
    [
      ((mem, [ ], [ (x, Type (Ex34/Ord.t)); (x_1, Type (Ex34/t)) ], Type (bool)),
        Match
          (173, Variable (?, Ex34/x_1),
            [
              (Constructor (Ex34/Empty), Constructor (173, false));
              (Constructor (Ex34/Node, l, v, r, Any),
                LetVar ? c =
                  Apply
                    (175,
                      Variable
                        (175,
                          Ex34/Ord.compare),
                      [
                        Variable
                          (175,
                            Ex34/x);
                        Variable
                          (175,
                            Ex34/v)
                      ])
                  in
                Apply
                  (176,
                    Variable
                      (176,
                        orb),
                    [
                      Apply
                        (176,
                          Variable
                            (176,
                              equiv_decb),
                          [
                            Variable
                              (176,
                                Ex34/c);
                            Constant
                              (176,
                                Int(0))
                          ]);
                      Apply
                        (176,
                          Variable
                            (176,
                              Ex34/mem),
                          [
                            Variable
                              (176,
                                Ex34/x);
                            IfThenElse
                              (176,
                                Apply
                                  (176,
                                    Variable
                                      (176,
                                        OCaml/Pervasives.lt),
                                    [
                                      Variable
                                        (176,
                                          Ex34/c);
                                      Constant
                                        (176,
                                          Int(0))
                                    ]),
                                Variable
                                  (176,
                                    Ex34/l),
                                Variable
                                  (176,
                                    Ex34/r))
                          ])
                    ]))
            ]))
    ])

179
Value
  (rec, @coq_rec,
    [
      ((remove, [ ], [ (x, Type (Ex34/Ord.t)); (x_1, Type (Ex34/t)) ],
        Monad
          ([
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], Type (Ex34/t))),
        Match
          (180, Variable (?, Ex34/x_1),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Constructor
                      (180,
                        Ex34/Empty)));
              (Constructor (Ex34/Node, l, v, r, Any),
                LetVar ? c =
                  Apply
                    (182,
                      Variable
                        (182,
                          Ex34/Ord.compare),
                      [
                        Variable
                          (182,
                            Ex34/x);
                        Variable
                          (182,
                            Ex34/v)
                      ])
                  in
                IfThenElse
                  (183,
                    Apply
                      (183,
                        Variable
                          (183,
                            equiv_decb),
                        [
                          Variable
                            (183,
                              Ex34/c);
                          Constant
                            (183,
                              Int(0))
                        ]),
                    Apply
                      (183,
                        Variable
                          (183,
                            Ex34/merge),
                        [
                          Variable
                            (183,
                              Ex34/l);
                          Variable
                            (183,
                              Ex34/r)
                        ]),
                    IfThenElse
                      (184,
                        Apply
                          (184,
                            Variable
                              (184,
                                OCaml/Pervasives.lt),
                            [
                              Variable
                                (184,
                                  Ex34/c);
                              Constant
                                (184,
                                  Int(0))
                            ]),
                        Bind
                          (?,
                            Apply
                              (184,
                                Variable
                                  (184,
                                    Ex34/remove),
                                [
                                  Variable
                                    (184,
                                      Ex34/x);
                                  Variable
                                    (184,
                                      Ex34/l)
                                ]),
                            Some
                              x_2,
                            Lift
                              (?,
                                [
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/invalid_argument))
                                ],
                                [
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/invalid_argument));
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/not_found))
                                ],
                                Apply
                                  (184,
                                    Variable
                                      (184,
                                        Ex34/bal),
                                    [
                                      Variable
                                        (?,
                                          Ex34/x_2);
                                      Variable
                                        (184,
                                          Ex34/v);
                                      Variable
                                        (184,
                                          Ex34/r)
                                    ]))),
                        Bind
                          (?,
                            Apply
                              (184,
                                Variable
                                  (184,
                                    Ex34/remove),
                                [
                                  Variable
                                    (184,
                                      Ex34/x);
                                  Variable
                                    (184,
                                      Ex34/r)
                                ]),
                            Some
                              x_2,
                            Lift
                              (?,
                                [
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/invalid_argument))
                                ],
                                [
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/invalid_argument));
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/not_found))
                                ],
                                Apply
                                  (184,
                                    Variable
                                      (184,
                                        Ex34/bal),
                                    [
                                      Variable
                                        (184,
                                          Ex34/l);
                                      Variable
                                        (184,
                                          Ex34/v);
                                      Variable
                                        (?,
                                          Ex34/x_2)
                                    ]))))))
            ]))
    ])

187
Value
  (rec, @.,
    [
      ((union_rec, [ ],
        [ (counter, Type (nat)); (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument))
          ], Type (Ex34/t))),
        Match
          (?, Variable (?, Ex34/counter),
            [
              (Constructor (O),
                Lift
                  (?,
                    [
                      Type
                        (NonTermination)
                    ],
                    [
                      Type
                        (Counter);
                      Type
                        (NonTermination);
                      Type
                        (OCaml/exception,
                          Type
                            (OCaml/invalid_argument))
                    ],
                    Apply
                      (?,
                        Variable
                          (?,
                            not_terminated),
                        [
                          Tuple
                            (?)
                        ])));
              (Constructor (S, counter),
                Match
                  (188,
                    Tuple
                      (188,
                        Variable
                          (188,
                            Ex34/s1),
                        Variable
                          (188,
                            Ex34/s2)),
                    [
                      (Tuple
                        (Constructor
                          (Ex34/Empty),
                          t2),
                        Return
                          (?,
                            Variable
                              (189,
                                Ex34/t2)));
                      (Tuple
                        (t1,
                          Constructor
                            (Ex34/Empty)),
                        Return
                          (?,
                            Variable
                              (190,
                                Ex34/t1)));
                      (Tuple
                        (Constructor
                          (Ex34/Node,
                            l1,
                            v1,
                            r1,
                            h1),
                          Constructor
                            (Ex34/Node,
                              l2,
                              v2,
                              r2,
                              h2)),
                        IfThenElse
                          (192,
                            Apply
                              (192,
                                Variable
                                  (192,
                                    OCaml/Pervasives.ge),
                                [
                                  Variable
                                    (192,
                                      Ex34/h1);
                                  Variable
                                    (192,
                                      Ex34/h2)
                                ]),
                            IfThenElse
                              (193,
                                Apply
                                  (193,
                                    Variable
                                      (193,
                                        equiv_decb),
                                    [
                                      Variable
                                        (193,
                                          Ex34/h2);
                                      Constant
                                        (193,
                                          Int(1))
                                    ]),
                                Lift
                                  (?,
                                    [
                                      Type
                                        (OCaml/exception,
                                          Type
                                            (OCaml/invalid_argument))
                                    ],
                                    [
                                      Type
                                        (Counter);
                                      Type
                                        (NonTermination);
                                      Type
                                        (OCaml/exception,
                                          Type
                                            (OCaml/invalid_argument))
                                    ],
                                    Apply
                                      (193,
                                        Variable
                                          (193,
                                            Ex34/add),
                                        [
                                          Variable
                                            (193,
                                              Ex34/v2);
                                          Variable
                                            (193,
                                              Ex34/s1)
                                        ])),
                                Bind
                                  (?,
                                    Apply
                                      (194,
                                        Variable
                                          (194,
                                            Ex34/split),
                                        [
                                          Variable
                                            (194,
                                              Ex34/v1);
                                          Variable
                                            (194,
                                              Ex34/s2)
                                        ]),
                                    Some
                                      x,
                                    Match
                                      (193,
                                        Variable
                                          (?,
                                            Ex34/x),
                                        [
                                          (Tuple
                                            (l2,
                                              Any,
                                              r2),
                                            Bind
                                              (?,
                                                Apply
                                                  (195,
                                                    Apply
                                                      (?,
                                                        Variable
                                                          (?,
                                                            Ex34/union_rec),
                                                        [
                                                          Variable
                                                            (?,
                                                              Ex34/counter)
                                                        ]),
                                                    [
                                                      Variable
                                                        (195,
                                                          Ex34/l1);
                                                      Variable
                                                        (195,
                                                          Ex34/l2)
                                                    ]),
                                                Some
                                                  x,
                                                Bind
                                                  (?,
                                                    Apply
                                                      (195,
                                                        Apply
                                                          (?,
                                                            Variable
                                                              (?,
                                                                Ex34/union_rec),
                                                            [
                                                              Variable
                                                                (?,
                                                                  Ex34/counter)
                                                            ]),
                                                        [
                                                          Variable
                                                            (195,
                                                              Ex34/r1);
                                                          Variable
                                                            (195,
                                                              Ex34/r2)
                                                        ]),
                                                    Some
                                                      x_1,
                                                    Apply
                                                      (195,
                                                        Variable
                                                          (195,
                                                            Ex34/join),
                                                        [
                                                          Variable
                                                            (?,
                                                              Ex34/x);
                                                          Variable
                                                            (195,
                                                              Ex34/v1);
                                                          Variable
                                                            (?,
                                                              Ex34/x_1)
                                                        ]))))
                                        ]))),
                            IfThenElse
                              (198,
                                Apply
                                  (198,
                                    Variable
                                      (198,
                                        equiv_decb),
                                    [
                                      Variable
                                        (198,
                                          Ex34/h1);
                                      Constant
                                        (198,
                                          Int(1))
                                    ]),
                                Lift
                                  (?,
                                    [
                                      Type
                                        (OCaml/exception,
                                          Type
                                            (OCaml/invalid_argument))
                                    ],
                                    [
                                      Type
                                        (Counter);
                                      Type
                                        (NonTermination);
                                      Type
                                        (OCaml/exception,
                                          Type
                                            (OCaml/invalid_argument))
                                    ],
                                    Apply
                                      (198,
                                        Variable
                                          (198,
                                            Ex34/add),
                                        [
                                          Variable
                                            (198,
                                              Ex34/v1);
                                          Variable
                                            (198,
                                              Ex34/s2)
                                        ])),
                                Bind
                                  (?,
                                    Apply
                                      (199,
                                        Variable
                                          (199,
                                            Ex34/split),
                                        [
                                          Variable
                                            (199,
                                              Ex34/v2);
                                          Variable
                                            (199,
                                              Ex34/s1)
                                        ]),
                                    Some
                                      x,
                                    Match
                                      (198,
                                        Variable
                                          (?,
                                            Ex34/x),
                                        [
                                          (Tuple
                                            (l1,
                                              Any,
                                              r1),
                                            Bind
                                              (?,
                                                Apply
                                                  (200,
                                                    Apply
                                                      (?,
                                                        Variable
                                                          (?,
                                                            Ex34/union_rec),
                                                        [
                                                          Variable
                                                            (?,
                                                              Ex34/counter)
                                                        ]),
                                                    [
                                                      Variable
                                                        (200,
                                                          Ex34/l1);
                                                      Variable
                                                        (200,
                                                          Ex34/l2)
                                                    ]),
                                                Some
                                                  x,
                                                Bind
                                                  (?,
                                                    Apply
                                                      (200,
                                                        Apply
                                                          (?,
                                                            Variable
                                                              (?,
                                                                Ex34/union_rec),
                                                            [
                                                              Variable
                                                                (?,
                                                                  Ex34/counter)
                                                            ]),
                                                        [
                                                          Variable
                                                            (200,
                                                              Ex34/r1);
                                                          Variable
                                                            (200,
                                                              Ex34/r2)
                                                        ]),
                                                    Some
                                                      x_1,
                                                    Apply
                                                      (200,
                                                        Variable
                                                          (200,
                                                            Ex34/join),
                                                        [
                                                          Variable
                                                            (?,
                                                              Ex34/x);
                                                          Variable
                                                            (200,
                                                              Ex34/v2);
                                                          Variable
                                                            (?,
                                                              Ex34/x_1)
                                                        ]))))
                                        ])))))
                    ]))
            ]))
    ])

187
Value
  (non_rec, @.,
    [
      ((union, [ ], [ (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument))
          ], Type (Ex34/t))),
        Bind
          (?,
            Lift
              (?, [ Type (Counter) ],
                [
                  Type (Counter);
                  Type (NonTermination);
                  Type
                    (OCaml/exception,
                      Type
                        (OCaml/invalid_argument))
                ],
                Apply (?, Variable (?, read_counter), [ Tuple (?) ])),
            Some x,
            Apply
              (?, Variable (?, Ex34/union_rec),
                [
                  Variable (?, Ex34/x);
                  Variable (?, Ex34/s1);
                  Variable (?, Ex34/s2)
                ])))
    ])

203
Value
  (rec, @coq_rec,
    [
      ((inter, [ ], [ (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], Type (Ex34/t))),
        Match
          (204,
            Tuple (204, Variable (204, Ex34/s1), Variable (204, Ex34/s2)),
            [
              (Tuple (Constructor (Ex34/Empty), t2),
                Return
                  (?,
                    Constructor
                      (205,
                        Ex34/Empty)));
              (Tuple (t1, Constructor (Ex34/Empty)),
                Return
                  (?,
                    Constructor
                      (206,
                        Ex34/Empty)));
              (Tuple (Constructor (Ex34/Node, l1, v1, r1, Any), t2),
                Bind
                  (?,
                    Lift
                      (?,
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/invalid_argument))
                        ],
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/invalid_argument));
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/not_found))
                        ],
                        Apply
                          (208,
                            Variable
                              (208,
                                Ex34/split),
                            [
                              Variable
                                (208,
                                  Ex34/v1);
                              Variable
                                (208,
                                  Ex34/t2)
                            ])),
                    Some
                      x,
                    Match
                      (208,
                        Variable
                          (?,
                            Ex34/x),
                        [
                          (Tuple
                            (l2,
                              Constructor
                                (false),
                              r2),
                            Bind
                              (?,
                                Apply
                                  (210,
                                    Variable
                                      (210,
                                        Ex34/inter),
                                    [
                                      Variable
                                        (210,
                                          Ex34/l1);
                                      Variable
                                        (210,
                                          Ex34/l2)
                                    ]),
                                Some
                                  x,
                                Bind
                                  (?,
                                    Apply
                                      (210,
                                        Variable
                                          (210,
                                            Ex34/inter),
                                        [
                                          Variable
                                            (210,
                                              Ex34/r1);
                                          Variable
                                            (210,
                                              Ex34/r2)
                                        ]),
                                    Some
                                      x_1,
                                    Apply
                                      (210,
                                        Variable
                                          (210,
                                            Ex34/concat),
                                        [
                                          Variable
                                            (?,
                                              Ex34/x);
                                          Variable
                                            (?,
                                              Ex34/x_1)
                                        ]))));
                          (Tuple
                            (l2,
                              Constructor
                                (true),
                              r2),
                            Bind
                              (?,
                                Apply
                                  (212,
                                    Variable
                                      (212,
                                        Ex34/inter),
                                    [
                                      Variable
                                        (212,
                                          Ex34/l1);
                                      Variable
                                        (212,
                                          Ex34/l2)
                                    ]),
                                Some
                                  x,
                                Bind
                                  (?,
                                    Apply
                                      (212,
                                        Variable
                                          (212,
                                            Ex34/inter),
                                        [
                                          Variable
                                            (212,
                                              Ex34/r1);
                                          Variable
                                            (212,
                                              Ex34/r2)
                                        ]),
                                    Some
                                      x_1,
                                    Lift
                                      (?,
                                        [
                                          Type
                                            (Counter);
                                          Type
                                            (NonTermination);
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/invalid_argument))
                                        ],
                                        [
                                          Type
                                            (Counter);
                                          Type
                                            (NonTermination);
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/invalid_argument));
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/not_found))
                                        ],
                                        Apply
                                          (212,
                                            Variable
                                              (212,
                                                Ex34/join),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/x);
                                              Variable
                                                (212,
                                                  Ex34/v1);
                                              Variable
                                                (?,
                                                  Ex34/x_1)
                                            ])))))
                        ])))
            ]))
    ])

215
Value
  (rec, @coq_rec,
    [
      ((diff, [ ], [ (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], Type (Ex34/t))),
        Match
          (216,
            Tuple (216, Variable (216, Ex34/s1), Variable (216, Ex34/s2)),
            [
              (Tuple (Constructor (Ex34/Empty), t2),
                Return
                  (?,
                    Constructor
                      (217,
                        Ex34/Empty)));
              (Tuple (t1, Constructor (Ex34/Empty)),
                Return (?, Variable (218, Ex34/t1)));
              (Tuple (Constructor (Ex34/Node, l1, v1, r1, Any), t2),
                Bind
                  (?,
                    Lift
                      (?,
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/invalid_argument))
                        ],
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/invalid_argument));
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/not_found))
                        ],
                        Apply
                          (220,
                            Variable
                              (220,
                                Ex34/split),
                            [
                              Variable
                                (220,
                                  Ex34/v1);
                              Variable
                                (220,
                                  Ex34/t2)
                            ])),
                    Some
                      x,
                    Match
                      (220,
                        Variable
                          (?,
                            Ex34/x),
                        [
                          (Tuple
                            (l2,
                              Constructor
                                (false),
                              r2),
                            Bind
                              (?,
                                Apply
                                  (222,
                                    Variable
                                      (222,
                                        Ex34/diff),
                                    [
                                      Variable
                                        (222,
                                          Ex34/l1);
                                      Variable
                                        (222,
                                          Ex34/l2)
                                    ]),
                                Some
                                  x,
                                Bind
                                  (?,
                                    Apply
                                      (222,
                                        Variable
                                          (222,
                                            Ex34/diff),
                                        [
                                          Variable
                                            (222,
                                              Ex34/r1);
                                          Variable
                                            (222,
                                              Ex34/r2)
                                        ]),
                                    Some
                                      x_1,
                                    Lift
                                      (?,
                                        [
                                          Type
                                            (Counter);
                                          Type
                                            (NonTermination);
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/invalid_argument))
                                        ],
                                        [
                                          Type
                                            (Counter);
                                          Type
                                            (NonTermination);
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/invalid_argument));
                                          Type
                                            (OCaml/exception,
                                              Type
                                                (OCaml/not_found))
                                        ],
                                        Apply
                                          (222,
                                            Variable
                                              (222,
                                                Ex34/join),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/x);
                                              Variable
                                                (222,
                                                  Ex34/v1);
                                              Variable
                                                (?,
                                                  Ex34/x_1)
                                            ])))));
                          (Tuple
                            (l2,
                              Constructor
                                (true),
                              r2),
                            Bind
                              (?,
                                Apply
                                  (224,
                                    Variable
                                      (224,
                                        Ex34/diff),
                                    [
                                      Variable
                                        (224,
                                          Ex34/l1);
                                      Variable
                                        (224,
                                          Ex34/l2)
                                    ]),
                                Some
                                  x,
                                Bind
                                  (?,
                                    Apply
                                      (224,
                                        Variable
                                          (224,
                                            Ex34/diff),
                                        [
                                          Variable
                                            (224,
                                              Ex34/r1);
                                          Variable
                                            (224,
                                              Ex34/r2)
                                        ]),
                                    Some
                                      x_1,
                                    Apply
                                      (224,
                                        Variable
                                          (224,
                                            Ex34/concat),
                                        [
                                          Variable
                                            (?,
                                              Ex34/x);
                                          Variable
                                            (?,
                                              Ex34/x_1)
                                        ]))))
                        ])))
            ]))
    ])

227
Inductive enumeration:
  ([ ],
    [
      (End, [ ]);
      (More, [ Type (Ex34/elt); Type (Ex34/t); Type (Ex34/enumeration) ])
    ])

229
Value
  (rec, @coq_rec,
    [
      ((cons_enum, [ ], [ (s, Type (Ex34/t)); (e, Type (Ex34/enumeration)) ],
        Type (Ex34/enumeration)),
        Match
          (230, Variable (230, Ex34/s),
            [
              (Constructor (Ex34/Empty), Variable (231, Ex34/e));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (232,
                    Variable
                      (232,
                        Ex34/cons_enum),
                    [
                      Variable
                        (232,
                          Ex34/l);
                      Constructor
                        (232,
                          Ex34/More,
                          Variable
                            (232,
                              Ex34/v),
                          Variable
                            (232,
                              Ex34/r),
                          Variable
                            (232,
                              Ex34/e))
                    ]))
            ]))
    ])

235
Value
  (rec, @.,
    [
      ((compare_aux_rec, [ ],
        [
          (counter, Type (nat));
          (e1, Type (Ex34/enumeration));
          (e2, Type (Ex34/enumeration))
        ], Monad ([ Type (NonTermination) ], Type (Z))),
        Match
          (?, Variable (?, Ex34/counter),
            [
              (Constructor (O),
                Apply
                  (?,
                    Variable
                      (?,
                        not_terminated),
                    [
                      Tuple
                        (?)
                    ]));
              (Constructor (S, counter),
                Match
                  (236,
                    Tuple
                      (236,
                        Variable
                          (236,
                            Ex34/e1),
                        Variable
                          (236,
                            Ex34/e2)),
                    [
                      (Tuple
                        (Constructor
                          (Ex34/End),
                          Constructor
                            (Ex34/End)),
                        Return
                          (?,
                            Constant
                              (237,
                                Int(0))));
                      (Tuple
                        (Constructor
                          (Ex34/End),
                          Any),
                        Return
                          (?,
                            Constant
                              (238,
                                Int(-1))));
                      (Tuple
                        (Any,
                          Constructor
                            (Ex34/End)),
                        Return
                          (?,
                            Constant
                              (239,
                                Int(1))));
                      (Tuple
                        (Constructor
                          (Ex34/More,
                            v1,
                            r1,
                            e1),
                          Constructor
                            (Ex34/More,
                              v2,
                              r2,
                              e2)),
                        LetVar
                          ?
                          c
                          =
                          Apply
                            (241,
                              Variable
                                (241,
                                  Ex34/Ord.compare),
                              [
                                Variable
                                  (241,
                                    Ex34/v1);
                                Variable
                                  (241,
                                    Ex34/v2)
                              ])
                          in
                        IfThenElse
                          (242,
                            Apply
                              (242,
                                Variable
                                  (242,
                                    nequiv_decb),
                                [
                                  Variable
                                    (242,
                                      Ex34/c);
                                  Constant
                                    (242,
                                      Int(0))
                                ]),
                            Return
                              (?,
                                Variable
                                  (243,
                                    Ex34/c)),
                            Apply
                              (244,
                                Apply
                                  (?,
                                    Variable
                                      (?,
                                        Ex34/compare_aux_rec),
                                    [
                                      Variable
                                        (?,
                                          Ex34/counter)
                                    ]),
                                [
                                  Apply
                                    (244,
                                      Variable
                                        (244,
                                          Ex34/cons_enum),
                                      [
                                        Variable
                                          (244,
                                            Ex34/r1);
                                        Variable
                                          (244,
                                            Ex34/e1)
                                      ]);
                                  Apply
                                    (244,
                                      Variable
                                        (244,
                                          Ex34/cons_enum),
                                      [
                                        Variable
                                          (244,
                                            Ex34/r2);
                                        Variable
                                          (244,
                                            Ex34/e2)
                                      ])
                                ])))
                    ]))
            ]))
    ])

235
Value
  (non_rec, @.,
    [
      ((compare_aux, [ ],
        [ (e1, Type (Ex34/enumeration)); (e2, Type (Ex34/enumeration)) ],
        Monad ([ Type (Counter); Type (NonTermination) ], Type (Z))),
        Bind
          (?,
            Lift
              (?, [ Type (Counter) ],
                [ Type (Counter); Type (NonTermination) ],
                Apply (?, Variable (?, read_counter), [ Tuple (?) ])),
            Some x,
            Lift
              (?, [ Type (NonTermination) ],
                [ Type (Counter); Type (NonTermination) ],
                Apply
                  (?, Variable (?, Ex34/compare_aux_rec),
                    [
                      Variable (?, Ex34/x);
                      Variable (?, Ex34/e1);
                      Variable (?, Ex34/e2)
                    ]))))
    ])

246
Value
  (non_rec, @.,
    [
      ((compare, [ ], [ (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad ([ Type (Counter); Type (NonTermination) ], Type (Z))),
        Apply
          (247, Variable (247, Ex34/compare_aux),
            [
              Apply
                (247, Variable (247, Ex34/cons_enum),
                  [
                    Variable
                      (247,
                        Ex34/s1);
                    Constructor
                      (247,
                        Ex34/End)
                  ]);
              Apply
                (247, Variable (247, Ex34/cons_enum),
                  [
                    Variable
                      (247,
                        Ex34/s2);
                    Constructor
                      (247,
                        Ex34/End)
                  ])
            ]))
    ])

249
Value
  (non_rec, @.,
    [
      ((equal, [ ], [ (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad ([ Type (Counter); Type (NonTermination) ], Type (bool))),
        Bind
          (?,
            Apply
              (250, Variable (250, Ex34/compare),
                [ Variable (250, Ex34/s1); Variable (250, Ex34/s2) ]),
            Some x,
            Return
              (?,
                Apply
                  (250, Variable (250, equiv_decb),
                    [
                      Variable (?, Ex34/x);
                      Constant (250, Int(0))
                    ]))))
    ])

252
Value
  (rec, @.,
    [
      ((subset_rec, [ ],
        [ (counter, Type (nat)); (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad ([ Type (NonTermination) ], Type (bool))),
        Match
          (?, Variable (?, Ex34/counter),
            [
              (Constructor (O),
                Apply
                  (?,
                    Variable
                      (?,
                        not_terminated),
                    [
                      Tuple
                        (?)
                    ]));
              (Constructor (S, counter),
                Match
                  (253,
                    Tuple
                      (253,
                        Variable
                          (253,
                            Ex34/s1),
                        Variable
                          (253,
                            Ex34/s2)),
                    [
                      (Tuple
                        (Constructor
                          (Ex34/Empty),
                          Any),
                        Return
                          (?,
                            Constructor
                              (255,
                                true)));
                      (Tuple
                        (Any,
                          Constructor
                            (Ex34/Empty)),
                        Return
                          (?,
                            Constructor
                              (257,
                                false)));
                      (Tuple
                        (Constructor
                          (Ex34/Node,
                            l1,
                            v1,
                            r1,
                            Any),
                          Alias
                            (Constructor
                              (Ex34/Node,
                                l2,
                                v2,
                                r2,
                                Any),
                              t2)),
                        LetVar
                          ?
                          c
                          =
                          Apply
                            (259,
                              Variable
                                (259,
                                  Ex34/Ord.compare),
                              [
                                Variable
                                  (259,
                                    Ex34/v1);
                                Variable
                                  (259,
                                    Ex34/v2)
                              ])
                          in
                        IfThenElse
                          (260,
                            Apply
                              (260,
                                Variable
                                  (260,
                                    equiv_decb),
                                [
                                  Variable
                                    (260,
                                      Ex34/c);
                                  Constant
                                    (260,
                                      Int(0))
                                ]),
                            Bind
                              (?,
                                Apply
                                  (261,
                                    Apply
                                      (?,
                                        Variable
                                          (?,
                                            Ex34/subset_rec),
                                        [
                                          Variable
                                            (?,
                                              Ex34/counter)
                                        ]),
                                    [
                                      Variable
                                        (261,
                                          Ex34/l1);
                                      Variable
                                        (261,
                                          Ex34/l2)
                                    ]),
                                Some
                                  x,
                                Bind
                                  (?,
                                    Apply
                                      (261,
                                        Apply
                                          (?,
                                            Variable
                                              (?,
                                                Ex34/subset_rec),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/counter)
                                            ]),
                                        [
                                          Variable
                                            (261,
                                              Ex34/r1);
                                          Variable
                                            (261,
                                              Ex34/r2)
                                        ]),
                                    Some
                                      x_1,
                                    Return
                                      (?,
                                        Apply
                                          (261,
                                            Variable
                                              (261,
                                                andb),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/x);
                                              Variable
                                                (?,
                                                  Ex34/x_1)
                                            ])))),
                            IfThenElse
                              (262,
                                Apply
                                  (262,
                                    Variable
                                      (262,
                                        OCaml/Pervasives.lt),
                                    [
                                      Variable
                                        (262,
                                          Ex34/c);
                                      Constant
                                        (262,
                                          Int(0))
                                    ]),
                                Bind
                                  (?,
                                    Apply
                                      (263,
                                        Apply
                                          (?,
                                            Variable
                                              (?,
                                                Ex34/subset_rec),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/counter)
                                            ]),
                                        [
                                          Constructor
                                            (263,
                                              Ex34/Node,
                                              Variable
                                                (263,
                                                  Ex34/l1),
                                              Variable
                                                (263,
                                                  Ex34/v1),
                                              Constructor
                                                (263,
                                                  Ex34/Empty),
                                              Constant
                                                (263,
                                                  Int(0)));
                                          Variable
                                            (263,
                                              Ex34/l2)
                                        ]),
                                    Some
                                      x,
                                    Bind
                                      (?,
                                        Apply
                                          (263,
                                            Apply
                                              (?,
                                                Variable
                                                  (?,
                                                    Ex34/subset_rec),
                                                [
                                                  Variable
                                                    (?,
                                                      Ex34/counter)
                                                ]),
                                            [
                                              Variable
                                                (263,
                                                  Ex34/r1);
                                              Variable
                                                (263,
                                                  Ex34/t2)
                                            ]),
                                        Some
                                          x_1,
                                        Return
                                          (?,
                                            Apply
                                              (263,
                                                Variable
                                                  (263,
                                                    andb),
                                                [
                                                  Variable
                                                    (?,
                                                      Ex34/x);
                                                  Variable
                                                    (?,
                                                      Ex34/x_1)
                                                ])))),
                                Bind
                                  (?,
                                    Apply
                                      (265,
                                        Apply
                                          (?,
                                            Variable
                                              (?,
                                                Ex34/subset_rec),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/counter)
                                            ]),
                                        [
                                          Constructor
                                            (265,
                                              Ex34/Node,
                                              Constructor
                                                (265,
                                                  Ex34/Empty),
                                              Variable
                                                (265,
                                                  Ex34/v1),
                                              Variable
                                                (265,
                                                  Ex34/r1),
                                              Constant
                                                (265,
                                                  Int(0)));
                                          Variable
                                            (265,
                                              Ex34/r2)
                                        ]),
                                    Some
                                      x,
                                    Bind
                                      (?,
                                        Apply
                                          (265,
                                            Apply
                                              (?,
                                                Variable
                                                  (?,
                                                    Ex34/subset_rec),
                                                [
                                                  Variable
                                                    (?,
                                                      Ex34/counter)
                                                ]),
                                            [
                                              Variable
                                                (265,
                                                  Ex34/l1);
                                              Variable
                                                (265,
                                                  Ex34/t2)
                                            ]),
                                        Some
                                          x_1,
                                        Return
                                          (?,
                                            Apply
                                              (265,
                                                Variable
                                                  (265,
                                                    andb),
                                                [
                                                  Variable
                                                    (?,
                                                      Ex34/x);
                                                  Variable
                                                    (?,
                                                      Ex34/x_1)
                                                ])))))))
                    ]))
            ]))
    ])

252
Value
  (non_rec, @.,
    [
      ((subset, [ ], [ (s1, Type (Ex34/t)); (s2, Type (Ex34/t)) ],
        Monad ([ Type (Counter); Type (NonTermination) ], Type (bool))),
        Bind
          (?,
            Lift
              (?, [ Type (Counter) ],
                [ Type (Counter); Type (NonTermination) ],
                Apply (?, Variable (?, read_counter), [ Tuple (?) ])),
            Some x,
            Lift
              (?, [ Type (NonTermination) ],
                [ Type (Counter); Type (NonTermination) ],
                Apply
                  (?, Variable (?, Ex34/subset_rec),
                    [
                      Variable (?, Ex34/x);
                      Variable (?, Ex34/s1);
                      Variable (?, Ex34/s2)
                    ]))))
    ])

267
Value
  (rec, @coq_rec,
    [
      ((iter, [ A ], [ (f, (Type (Ex34/elt) -> A)); (x, Type (Ex34/t)) ],
        Type (unit)),
        Match
          (268, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Constructor (268, tt));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (269,
                    Variable
                      (269,
                        Ex34/iter),
                    [
                      Variable
                        (269,
                          Ex34/f);
                      Variable
                        (269,
                          Ex34/r)
                    ]))
            ]))
    ])

272
Value
  (rec, @coq_rec,
    [
      ((fold, [ A ],
        [ (f, (Type (Ex34/elt) -> (A -> A))); (s, Type (Ex34/t)); (accu, A) ],
        A),
        Match
          (273, Variable (273, Ex34/s),
            [
              (Constructor (Ex34/Empty), Variable (274, Ex34/accu));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (275,
                    Variable
                      (275,
                        Ex34/fold),
                    [
                      Variable
                        (275,
                          Ex34/f);
                      Variable
                        (275,
                          Ex34/r);
                      Apply
                        (275,
                          Variable
                            (275,
                              Ex34/f),
                          [
                            Variable
                              (275,
                                Ex34/v);
                            Apply
                              (275,
                                Variable
                                  (275,
                                    Ex34/fold),
                                [
                                  Variable
                                    (275,
                                      Ex34/f);
                                  Variable
                                    (275,
                                      Ex34/l);
                                  Variable
                                    (275,
                                      Ex34/accu)
                                ])
                          ])
                    ]))
            ]))
    ])

278
Value
  (rec, @coq_rec,
    [
      ((for_all, [ ],
        [ (p, (Type (Ex34/elt) -> Type (bool))); (x, Type (Ex34/t)) ],
        Type (bool)),
        Match
          (279, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Constructor (279, true));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (280,
                    Variable
                      (280,
                        andb),
                    [
                      Apply
                        (280,
                          Variable
                            (280,
                              Ex34/p),
                          [
                            Variable
                              (280,
                                Ex34/v)
                          ]);
                      Apply
                        (280,
                          Variable
                            (280,
                              andb),
                          [
                            Apply
                              (280,
                                Variable
                                  (280,
                                    Ex34/for_all),
                                [
                                  Variable
                                    (280,
                                      Ex34/p);
                                  Variable
                                    (280,
                                      Ex34/l)
                                ]);
                            Apply
                              (280,
                                Variable
                                  (280,
                                    Ex34/for_all),
                                [
                                  Variable
                                    (280,
                                      Ex34/p);
                                  Variable
                                    (280,
                                      Ex34/r)
                                ])
                          ])
                    ]))
            ]))
    ])

283
Value
  (rec, @coq_rec,
    [
      ((exists_, [ ],
        [ (p, (Type (Ex34/elt) -> Type (bool))); (x, Type (Ex34/t)) ],
        Type (bool)),
        Match
          (284, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Constructor (284, false));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (285,
                    Variable
                      (285,
                        orb),
                    [
                      Apply
                        (285,
                          Variable
                            (285,
                              Ex34/p),
                          [
                            Variable
                              (285,
                                Ex34/v)
                          ]);
                      Apply
                        (285,
                          Variable
                            (285,
                              orb),
                          [
                            Apply
                              (285,
                                Variable
                                  (285,
                                    Ex34/exists_),
                                [
                                  Variable
                                    (285,
                                      Ex34/p);
                                  Variable
                                    (285,
                                      Ex34/l)
                                ]);
                            Apply
                              (285,
                                Variable
                                  (285,
                                    Ex34/exists_),
                                [
                                  Variable
                                    (285,
                                      Ex34/p);
                                  Variable
                                    (285,
                                      Ex34/r)
                                ])
                          ])
                    ]))
            ]))
    ])

288
Value
  (rec, @coq_rec,
    [
      ((filter, [ ],
        [ (p, (Type (Ex34/elt) -> Type (bool))); (x, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], Type (Ex34/t))),
        Match
          (289, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Constructor
                      (289,
                        Ex34/Empty)));
              (Constructor (Ex34/Node, l, v, r, Any),
                Bind
                  (?,
                    Apply
                      (292,
                        Variable
                          (292,
                            Ex34/filter),
                        [
                          Variable
                            (292,
                              Ex34/p);
                          Variable
                            (292,
                              Ex34/l)
                        ]),
                    Some
                      l',
                    LetVar
                      ?
                      pv
                      =
                      Apply
                        (293,
                          Variable
                            (293,
                              Ex34/p),
                          [
                            Variable
                              (293,
                                Ex34/v)
                          ])
                      in
                    Bind
                      (?,
                        Apply
                          (294,
                            Variable
                              (294,
                                Ex34/filter),
                            [
                              Variable
                                (294,
                                  Ex34/p);
                              Variable
                                (294,
                                  Ex34/r)
                            ]),
                        Some
                          r',
                        IfThenElse
                          (295,
                            Variable
                              (295,
                                Ex34/pv),
                            Lift
                              (?,
                                [
                                  Type
                                    (Counter);
                                  Type
                                    (NonTermination);
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/invalid_argument))
                                ],
                                [
                                  Type
                                    (Counter);
                                  Type
                                    (NonTermination);
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/invalid_argument));
                                  Type
                                    (OCaml/exception,
                                      Type
                                        (OCaml/not_found))
                                ],
                                Apply
                                  (295,
                                    Variable
                                      (295,
                                        Ex34/join),
                                    [
                                      Variable
                                        (295,
                                          Ex34/l');
                                      Variable
                                        (295,
                                          Ex34/v);
                                      Variable
                                        (295,
                                          Ex34/r')
                                    ])),
                            Apply
                              (295,
                                Variable
                                  (295,
                                    Ex34/concat),
                                [
                                  Variable
                                    (295,
                                      Ex34/l');
                                  Variable
                                    (295,
                                      Ex34/r')
                                ])))))
            ]))
    ])

298
Value
  (rec, @coq_rec,
    [
      ((partition, [ ],
        [ (p, (Type (Ex34/elt) -> Type (bool))); (x, Type (Ex34/t)) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/invalid_argument));
            Type (OCaml/exception, Type (OCaml/not_found))
          ], (Type (Ex34/t) * Type (Ex34/t)))),
        Match
          (299, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty),
                Return
                  (?,
                    Tuple
                      (299,
                        Constructor
                          (299,
                            Ex34/Empty),
                        Constructor
                          (299,
                            Ex34/Empty))));
              (Constructor (Ex34/Node, l, v, r, Any),
                Bind
                  (?,
                    Apply
                      (302,
                        Variable
                          (302,
                            Ex34/partition),
                        [
                          Variable
                            (302,
                              Ex34/p);
                          Variable
                            (302,
                              Ex34/l)
                        ]),
                    Some
                      x_1,
                    Match
                      (302,
                        Variable
                          (?,
                            Ex34/x_1),
                        [
                          (Tuple
                            (lt,
                              lf),
                            LetVar
                              ?
                              pv
                              =
                              Apply
                                (303,
                                  Variable
                                    (303,
                                      Ex34/p),
                                  [
                                    Variable
                                      (303,
                                        Ex34/v)
                                  ])
                              in
                            Bind
                              (?,
                                Apply
                                  (304,
                                    Variable
                                      (304,
                                        Ex34/partition),
                                    [
                                      Variable
                                        (304,
                                          Ex34/p);
                                      Variable
                                        (304,
                                          Ex34/r)
                                    ]),
                                Some
                                  x_1,
                                Match
                                  (304,
                                    Variable
                                      (?,
                                        Ex34/x_1),
                                    [
                                      (Tuple
                                        (rt,
                                          rf),
                                        IfThenElse
                                          (305,
                                            Variable
                                              (305,
                                                Ex34/pv),
                                            Bind
                                              (?,
                                                Lift
                                                  (?,
                                                    [
                                                      Type
                                                        (Counter);
                                                      Type
                                                        (NonTermination);
                                                      Type
                                                        (OCaml/exception,
                                                          Type
                                                            (OCaml/invalid_argument))
                                                    ],
                                                    [
                                                      Type
                                                        (Counter);
                                                      Type
                                                        (NonTermination);
                                                      Type
                                                        (OCaml/exception,
                                                          Type
                                                            (OCaml/invalid_argument));
                                                      Type
                                                        (OCaml/exception,
                                                          Type
                                                            (OCaml/not_found))
                                                    ],
                                                    Apply
                                                      (306,
                                                        Variable
                                                          (306,
                                                            Ex34/join),
                                                        [
                                                          Variable
                                                            (306,
                                                              Ex34/lt);
                                                          Variable
                                                            (306,
                                                              Ex34/v);
                                                          Variable
                                                            (306,
                                                              Ex34/rt)
                                                        ])),
                                                Some
                                                  x_1,
                                                Bind
                                                  (?,
                                                    Apply
                                                      (306,
                                                        Variable
                                                          (306,
                                                            Ex34/concat),
                                                        [
                                                          Variable
                                                            (306,
                                                              Ex34/lf);
                                                          Variable
                                                            (306,
                                                              Ex34/rf)
                                                        ]),
                                                    Some
                                                      x_2,
                                                    Return
                                                      (?,
                                                        Tuple
                                                          (306,
                                                            Variable
                                                              (?,
                                                                Ex34/x_1),
                                                            Variable
                                                              (?,
                                                                Ex34/x_2))))),
                                            Bind
                                              (?,
                                                Apply
                                                  (307,
                                                    Variable
                                                      (307,
                                                        Ex34/concat),
                                                    [
                                                      Variable
                                                        (307,
                                                          Ex34/lt);
                                                      Variable
                                                        (307,
                                                          Ex34/rt)
                                                    ]),
                                                Some
                                                  x_1,
                                                Bind
                                                  (?,
                                                    Lift
                                                      (?,
                                                        [
                                                          Type
                                                            (Counter);
                                                          Type
                                                            (NonTermination);
                                                          Type
                                                            (OCaml/exception,
                                                              Type
                                                                (OCaml/invalid_argument))
                                                        ],
                                                        [
                                                          Type
                                                            (Counter);
                                                          Type
                                                            (NonTermination);
                                                          Type
                                                            (OCaml/exception,
                                                              Type
                                                                (OCaml/invalid_argument));
                                                          Type
                                                            (OCaml/exception,
                                                              Type
                                                                (OCaml/not_found))
                                                        ],
                                                        Apply
                                                          (307,
                                                            Variable
                                                              (307,
                                                                Ex34/join),
                                                            [
                                                              Variable
                                                                (307,
                                                                  Ex34/lf);
                                                              Variable
                                                                (307,
                                                                  Ex34/v);
                                                              Variable
                                                                (307,
                                                                  Ex34/rf)
                                                            ])),
                                                    Some
                                                      x_2,
                                                    Return
                                                      (?,
                                                        Tuple
                                                          (307,
                                                            Variable
                                                              (?,
                                                                Ex34/x_1),
                                                            Variable
                                                              (?,
                                                                Ex34/x_2)))))))
                                    ])))
                        ])))
            ]))
    ])

310
Value
  (rec, @coq_rec,
    [
      ((cardinal, [ ], [ (x, Type (Ex34/t)) ], Type (Z)),
        Match
          (311, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Constant (311, Int(0)));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (312,
                    Variable
                      (312,
                        Z.add),
                    [
                      Apply
                        (312,
                          Variable
                            (312,
                              Z.add),
                          [
                            Apply
                              (312,
                                Variable
                                  (312,
                                    Ex34/cardinal),
                                [
                                  Variable
                                    (312,
                                      Ex34/l)
                                ]);
                            Constant
                              (312,
                                Int(1))
                          ]);
                      Apply
                        (312,
                          Variable
                            (312,
                              Ex34/cardinal),
                          [
                            Variable
                              (312,
                                Ex34/r)
                          ])
                    ]))
            ]))
    ])

315
Value
  (rec, @coq_rec,
    [
      ((elements_aux, [ ],
        [ (accu, Type (list, Type (Ex34/elt))); (x, Type (Ex34/t)) ],
        Type (list, Type (Ex34/elt))),
        Match
          (316, Variable (?, Ex34/x),
            [
              (Constructor (Ex34/Empty), Variable (316, Ex34/accu));
              (Constructor (Ex34/Node, l, v, r, Any),
                Apply
                  (317,
                    Variable
                      (317,
                        Ex34/elements_aux),
                    [
                      Constructor
                        (317,
                          cons,
                          Variable
                            (317,
                              Ex34/v),
                          Apply
                            (317,
                              Variable
                                (317,
                                  Ex34/elements_aux),
                              [
                                Variable
                                  (317,
                                    Ex34/accu);
                                Variable
                                  (317,
                                    Ex34/r)
                              ]));
                      Variable
                        (317,
                          Ex34/l)
                    ]))
            ]))
    ])

320
Value
  (non_rec, @.,
    [
      ((elements, [ ], [ (s, Type (Ex34/t)) ], Type (list, Type (Ex34/elt))),
        Apply
          (321, Variable (321, Ex34/elements_aux),
            [ Constructor (321, []); Variable (321, Ex34/s) ]))
    ])

323
Value
  (non_rec, @.,
    [
      ((choose, [ ], [ ],
        (Type (Ex34/t) ->
          Monad
            ([ Type (OCaml/exception, Type (OCaml/not_found)) ],
              Type (Ex34/elt)))), Variable (323, Ex34/min_elt))
    ])

325
Value
  (rec, @coq_rec,
    [
      ((find, [ ], [ (x, Type (Ex34/Ord.t)); (x_1, Type (Ex34/t)) ],
        Monad
          ([ Type (OCaml/exception, Type (OCaml/not_found)) ],
            Type (Ex34/elt))),
        Match
          (326, Variable (?, Ex34/x_1),
            [
              (Constructor (Ex34/Empty),
                Apply
                  (326,
                    Variable
                      (326,
                        OCaml/Pervasives.raise),
                    [
                      Constructor
                        (326,
                          OCaml/Not_found,
                          Tuple
                            (?))
                    ]));
              (Constructor (Ex34/Node, l, v, r, Any),
                LetVar ? c =
                  Apply
                    (328,
                      Variable
                        (328,
                          Ex34/Ord.compare),
                      [
                        Variable
                          (328,
                            Ex34/x);
                        Variable
                          (328,
                            Ex34/v)
                      ])
                  in
                IfThenElse
                  (329,
                    Apply
                      (329,
                        Variable
                          (329,
                            equiv_decb),
                        [
                          Variable
                            (329,
                              Ex34/c);
                          Constant
                            (329,
                              Int(0))
                        ]),
                    Return
                      (?,
                        Variable
                          (329,
                            Ex34/v)),
                    Apply
                      (330,
                        Variable
                          (330,
                            Ex34/find),
                        [
                          Variable
                            (330,
                              Ex34/x);
                          IfThenElse
                            (330,
                              Apply
                                (330,
                                  Variable
                                    (330,
                                      OCaml/Pervasives.lt),
                                  [
                                    Variable
                                      (330,
                                        Ex34/c);
                                    Constant
                                      (330,
                                        Int(0))
                                  ]),
                              Variable
                                (330,
                                  Ex34/l),
                              Variable
                                (330,
                                  Ex34/r))
                        ])))
            ]))
    ])

333
Value
  (non_rec, @.,
    [
      ((of_sorted_list, [ ], [ (l, Type (list, Type (Ex34/elt))) ],
        Monad
          ([
            Type (Counter);
            Type (NonTermination);
            Type (OCaml/exception, Type (OCaml/assert_failure))
          ], Type (Ex34/t))),
        LetFun 334
          (rec, @.,
            [
              ((sub_rec, [ ],
                [
                  (counter, Type (nat));
                  (n, Type (Z));
                  (l,
                    Type
                      (list,
                        Type
                          (Ex34/elt)))
                ],
                Monad
                  ([
                    Type
                      (NonTermination);
                    Type
                      (OCaml/exception,
                        Type
                          (OCaml/assert_failure))
                  ],
                    (Type
                      (Ex34/t)
                      *
                      Type
                        (list,
                          Type
                            (Ex34/elt))))),
                Match
                  (?,
                    Variable
                      (?,
                        Ex34/counter),
                    [
                      (Constructor
                        (O),
                        Lift
                          (?,
                            [
                              Type
                                (NonTermination)
                            ],
                            [
                              Type
                                (NonTermination);
                              Type
                                (OCaml/exception,
                                  Type
                                    (OCaml/assert_failure))
                            ],
                            Apply
                              (?,
                                Variable
                                  (?,
                                    not_terminated),
                                [
                                  Tuple
                                    (?)
                                ])));
                      (Constructor
                        (S,
                          counter),
                        Match
                          (335,
                            Tuple
                              (335,
                                Variable
                                  (335,
                                    Ex34/n),
                                Variable
                                  (335,
                                    Ex34/l)),
                            [
                              (Tuple
                                (Int(0),
                                  l),
                                Return
                                  (?,
                                    Tuple
                                      (336,
                                        Constructor
                                          (336,
                                            Ex34/Empty),
                                        Variable
                                          (336,
                                            Ex34/l))));
                              (Tuple
                                (Int(1),
                                  Constructor
                                    (cons,
                                      x0,
                                      l)),
                                Return
                                  (?,
                                    Tuple
                                      (337,
                                        Constructor
                                          (337,
                                            Ex34/Node,
                                            Constructor
                                              (337,
                                                Ex34/Empty),
                                            Variable
                                              (337,
                                                Ex34/x0),
                                            Constructor
                                              (337,
                                                Ex34/Empty),
                                            Constant
                                              (337,
                                                Int(1))),
                                        Variable
                                          (337,
                                            Ex34/l))));
                              (Tuple
                                (Int(2),
                                  Constructor
                                    (cons,
                                      x0,
                                      Constructor
                                        (cons,
                                          x1,
                                          l))),
                                Return
                                  (?,
                                    Tuple
                                      (338,
                                        Constructor
                                          (338,
                                            Ex34/Node,
                                            Constructor
                                              (338,
                                                Ex34/Node,
                                                Constructor
                                                  (338,
                                                    Ex34/Empty),
                                                Variable
                                                  (338,
                                                    Ex34/x0),
                                                Constructor
                                                  (338,
                                                    Ex34/Empty),
                                                Constant
                                                  (338,
                                                    Int(1))),
                                            Variable
                                              (338,
                                                Ex34/x1),
                                            Constructor
                                              (338,
                                                Ex34/Empty),
                                            Constant
                                              (338,
                                                Int(2))),
                                        Variable
                                          (338,
                                            Ex34/l))));
                              (Tuple
                                (Int(3),
                                  Constructor
                                    (cons,
                                      x0,
                                      Constructor
                                        (cons,
                                          x1,
                                          Constructor
                                            (cons,
                                              x2,
                                              l)))),
                                Return
                                  (?,
                                    Tuple
                                      (339,
                                        Constructor
                                          (339,
                                            Ex34/Node,
                                            Constructor
                                              (339,
                                                Ex34/Node,
                                                Constructor
                                                  (339,
                                                    Ex34/Empty),
                                                Variable
                                                  (339,
                                                    Ex34/x0),
                                                Constructor
                                                  (339,
                                                    Ex34/Empty),
                                                Constant
                                                  (339,
                                                    Int(1))),
                                            Variable
                                              (339,
                                                Ex34/x1),
                                            Constructor
                                              (339,
                                                Ex34/Node,
                                                Constructor
                                                  (339,
                                                    Ex34/Empty),
                                                Variable
                                                  (339,
                                                    Ex34/x2),
                                                Constructor
                                                  (339,
                                                    Ex34/Empty),
                                                Constant
                                                  (339,
                                                    Int(1))),
                                            Constant
                                              (339,
                                                Int(2))),
                                        Variable
                                          (339,
                                            Ex34/l))));
                              (Tuple
                                (n,
                                  l),
                                LetVar
                                  ?
                                  nl
                                  =
                                  Apply
                                    (341,
                                      Variable
                                        (341,
                                          Z.div),
                                      [
                                        Variable
                                          (341,
                                            Ex34/n);
                                        Constant
                                          (341,
                                            Int(2))
                                      ])
                                  in
                                Bind
                                  (?,
                                    Apply
                                      (342,
                                        Apply
                                          (?,
                                            Variable
                                              (?,
                                                Ex34/sub_rec),
                                            [
                                              Variable
                                                (?,
                                                  Ex34/counter)
                                            ]),
                                        [
                                          Variable
                                            (342,
                                              Ex34/nl);
                                          Variable
                                            (342,
                                              Ex34/l)
                                        ]),
                                    Some
                                      x,
                                    Match
                                      (342,
                                        Variable
                                          (?,
                                            Ex34/x),
                                        [
                                          (Tuple
                                            (left_,
                                              l),
                                            Match
                                              (343,
                                                Variable
                                                  (343,
                                                    Ex34/l),
                                                [
                                                  (Constructor
                                                    ([]),
                                                    Lift
                                                      (?,
                                                        [
                                                          Type
                                                            (OCaml/exception,
                                                              Type
                                                                (OCaml/assert_failure))
                                                        ],
                                                        [
                                                          Type
                                                            (NonTermination);
                                                          Type
                                                            (OCaml/exception,
                                                              Type
                                                                (OCaml/assert_failure))
                                                        ],
                                                        Apply
                                                          (344,
                                                            Variable
                                                              (344,
                                                                OCaml/assert),
                                                            [
                                                              Constructor
                                                                (344,
                                                                  false)
                                                            ])));
                                                  (Constructor
                                                    (cons,
                                                      mid,
                                                      l),
                                                    Bind
                                                      (?,
                                                        Apply
                                                          (346,
                                                            Apply
                                                              (?,
                                                                Variable
                                                                  (?,
                                                                    Ex34/sub_rec),
                                                                [
                                                                  Variable
                                                                    (?,
                                                                      Ex34/counter)
                                                                ]),
                                                            [
                                                              Apply
                                                                (346,
                                                                  Variable
                                                                    (346,
                                                                      Z.sub),
                                                                  [
                                                                    Apply
                                                                      (346,
                                                                        Variable
                                                                          (346,
                                                                            Z.sub),
                                                                        [
                                                                          Variable
                                                                            (346,
                                                                              Ex34/n);
                                                                          Variable
                                                                            (346,
                                                                              Ex34/nl)
                                                                        ]);
                                                                    Constant
                                                                      (346,
                                                                        Int(1))
                                                                  ]);
                                                              Variable
                                                                (346,
                                                                  Ex34/l)
                                                            ]),
                                                        Some
                                                          x,
                                                        Match
                                                          (346,
                                                            Variable
                                                              (?,
                                                                Ex34/x),
                                                            [
                                                              (Tuple
                                                                (right_,
                                                                  l),
                                                                Return
                                                                  (?,
                                                                    Tuple
                                                                      (347,
                                                                        Apply
                                                                          (347,
                                                                            Variable
                                                                              (347,
                                                                                Ex34/create),
                                                                            [
                                                                              Variable
                                                                                (347,
                                                                                  Ex34/left_);
                                                                              Variable
                                                                                (347,
                                                                                  Ex34/mid);
                                                                              Variable
                                                                                (347,
                                                                                  Ex34/right_)
                                                                            ]),
                                                                        Variable
                                                                          (347,
                                                                            Ex34/l))))
                                                            ])))
                                                ]))
                                        ])))
                            ]))
                    ]))
            ]) in
        LetFun 334
          (non_rec, @.,
            [
              ((sub, [ ],
                [
                  (n, Type (Z));
                  (l,
                    Type
                      (list,
                        Type
                          (Ex34/elt)))
                ],
                Monad
                  ([
                    Type
                      (Counter);
                    Type
                      (NonTermination);
                    Type
                      (OCaml/exception,
                        Type
                          (OCaml/assert_failure))
                  ],
                    (Type
                      (Ex34/t)
                      *
                      Type
                        (list,
                          Type
                            (Ex34/elt))))),
                Bind
                  (?,
                    Lift
                      (?,
                        [
                          Type
                            (Counter)
                        ],
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/assert_failure))
                        ],
                        Apply
                          (?,
                            Variable
                              (?,
                                read_counter),
                            [
                              Tuple
                                (?)
                            ])),
                    Some
                      x,
                    Lift
                      (?,
                        [
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/assert_failure))
                        ],
                        [
                          Type
                            (Counter);
                          Type
                            (NonTermination);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/assert_failure))
                        ],
                        Apply
                          (?,
                            Variable
                              (?,
                                Ex34/sub_rec),
                            [
                              Variable
                                (?,
                                  Ex34/x);
                              Variable
                                (?,
                                  Ex34/n);
                              Variable
                                (?,
                                  Ex34/l)
                            ]))))
            ]) in
        Bind
          (?,
            Apply
              (349, Variable (349, Ex34/sub),
                [
                  Apply
                    (349,
                      Variable
                        (349,
                          List.length),
                      [
                        Variable
                          (349,
                            Ex34/l)
                      ]);
                  Variable (349, Ex34/l)
                ]), Some x,
            Return
              (?,
                Apply
                  (349, Variable (349, fst),
                    [ Variable (?, Ex34/x) ]))))
    ])
