1 Reference (r, r_state, Type (Z), Constant (1, Int(12)))

3
Value
  (non_rec, @.,
    [
      ((plus_one, [ A ], [ (x, A) ],
        Monad
          ([ Type (OCaml/Effect.State.state, Type (Z)); Type (Ex18/r_state) ],
            Type (Z))),
        Match
          (3, Variable (?, Ex18/x),
            [
              (Any,
                Bind
                  (?,
                    Bind
                      (?,
                        Variable
                          (4,
                            Ex18/r),
                        Some
                          x_1,
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/Effect.State.state,
                                  Type
                                    (Z))
                            ],
                            [
                              Type
                                (OCaml/Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (Ex18/r_state)
                            ],
                            Apply
                              (4,
                                Variable
                                  (4,
                                    OCaml/Effect.State.read),
                                [
                                  Variable
                                    (?,
                                      Ex18/x_1)
                                ]))),
                    Some
                      x_1,
                    Return
                      (?,
                        Apply
                          (4,
                            Variable
                              (4,
                                Z.add),
                            [
                              Variable
                                (?,
                                  Ex18/x_1);
                              Constant
                                (4,
                                  Int(1))
                            ]))))
            ]))
    ])

6 Reference (s, s_state, Type (string), Constant (6, String("Hi")))

8
Value
  (non_rec, @.,
    [
      ((fail, [ A; B ], [ (x, A) ],
        Monad
          ([
            Type (OCaml/Effect.State.state, Type (string));
            Type (Ex18/s_state);
            Type (OCaml/exception, Type (OCaml/failure))
          ], B)),
        Match
          (8, Variable (?, Ex18/x),
            [
              (Any,
                Bind
                  (?,
                    Lift
                      (?,
                        [
                          Type
                            (OCaml/Effect.State.state,
                              Type
                                (string));
                          Type
                            (Ex18/s_state)
                        ],
                        [
                          Type
                            (OCaml/Effect.State.state,
                              Type
                                (string));
                          Type
                            (Ex18/s_state);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/failure))
                        ],
                        Bind
                          (?,
                            Variable
                              (8,
                                Ex18/s),
                            Some
                              x_1,
                            Lift
                              (?,
                                [
                                  Type
                                    (OCaml/Effect.State.state,
                                      Type
                                        (string))
                                ],
                                [
                                  Type
                                    (OCaml/Effect.State.state,
                                      Type
                                        (string));
                                  Type
                                    (Ex18/s_state)
                                ],
                                Apply
                                  (8,
                                    Variable
                                      (8,
                                        OCaml/Effect.State.read),
                                    [
                                      Variable
                                        (?,
                                          Ex18/x_1)
                                    ])))),
                    Some
                      x_1,
                    Lift
                      (?,
                        [
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/failure))
                        ],
                        [
                          Type
                            (OCaml/Effect.State.state,
                              Type
                                (string));
                          Type
                            (Ex18/s_state);
                          Type
                            (OCaml/exception,
                              Type
                                (OCaml/failure))
                        ],
                        Apply
                          (8,
                            Variable
                              (8,
                                OCaml/Pervasives.failwith),
                            [
                              Variable
                                (?,
                                  Ex18/x_1)
                            ]))))
            ]))
    ])

10
Value
  (non_rec, @.,
    [
      ((reset, [ A ], [ (x, A) ],
        Monad
          ([ Type (OCaml/Effect.State.state, Type (Z)); Type (Ex18/r_state) ],
            Type (unit))),
        Match
          (10, Variable (?, Ex18/x),
            [
              (Any,
                Bind
                  (?,
                    Variable
                      (11,
                        Ex18/r),
                    Some
                      x_1,
                    Lift
                      (?,
                        [
                          Type
                            (OCaml/Effect.State.state,
                              Type
                                (Z))
                        ],
                        [
                          Type
                            (OCaml/Effect.State.state,
                              Type
                                (Z));
                          Type
                            (Ex18/r_state)
                        ],
                        Apply
                          (11,
                            Variable
                              (11,
                                OCaml/Effect.State.write),
                            [
                              Variable
                                (?,
                                  Ex18/x_1);
                              Constant
                                (11,
                                  Int(0))
                            ]))))
            ]))
    ])

13
Value
  (non_rec, @.,
    [
      ((incr, [ A ], [ (x, A) ],
        Monad
          ([ Type (OCaml/Effect.State.state, Type (Z)); Type (Ex18/r_state) ],
            Type (unit))),
        Match
          (13, Variable (?, Ex18/x),
            [
              (Any,
                Bind
                  (?,
                    Variable
                      (14,
                        Ex18/r),
                    Some
                      x_1,
                    Bind
                      (?,
                        Bind
                          (?,
                            Bind
                              (?,
                                Variable
                                  (14,
                                    Ex18/r),
                                Some
                                  x_2,
                                Lift
                                  (?,
                                    [
                                      Type
                                        (OCaml/Effect.State.state,
                                          Type
                                            (Z))
                                    ],
                                    [
                                      Type
                                        (OCaml/Effect.State.state,
                                          Type
                                            (Z));
                                      Type
                                        (Ex18/r_state)
                                    ],
                                    Apply
                                      (14,
                                        Variable
                                          (14,
                                            OCaml/Effect.State.read),
                                        [
                                          Variable
                                            (?,
                                              Ex18/x_2)
                                        ]))),
                            Some
                              x_2,
                            Return
                              (?,
                                Apply
                                  (14,
                                    Variable
                                      (14,
                                        Z.add),
                                    [
                                      Variable
                                        (?,
                                          Ex18/x_2);
                                      Constant
                                        (14,
                                          Int(1))
                                    ]))),
                        Some
                          x_2,
                        Lift
                          (?,
                            [
                              Type
                                (OCaml/Effect.State.state,
                                  Type
                                    (Z))
                            ],
                            [
                              Type
                                (OCaml/Effect.State.state,
                                  Type
                                    (Z));
                              Type
                                (Ex18/r_state)
                            ],
                            Apply
                              (14,
                                Variable
                                  (14,
                                    OCaml/Effect.State.write),
                                [
                                  Variable
                                    (?,
                                      Ex18/x_1);
                                  Variable
                                    (?,
                                      Ex18/x_2)
                                ])))))
            ]))
    ])
